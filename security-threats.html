<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>A Security Threat Analysis for Routing over Low-Power and Lossy Networks</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  max-width: 55em;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents"/>
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction"/>
<link href="#rfc.section.2" rel="Chapter" title="2 Terminology"/>
<link href="#rfc.section.3" rel="Chapter" title="3 Considerations on ROLL Security"/>
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Routing Assets and Points of Access"/>
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 The ISO 7498-2 Security Reference Model"/>
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Issues Specific to or Amplified in LLNs"/>
<link href="#rfc.section.3.4" rel="Chapter" title="3.4 ROLL Security Objectives"/>
<link href="#rfc.section.4" rel="Chapter" title="4 Threat Sources"/>
<link href="#rfc.section.5" rel="Chapter" title="5 Threats and Attacks"/>
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 Threats due to failures to Authenticate"/>
<link href="#rfc.section.5.1.1" rel="Chapter" title="5.1.1 Node Impersonation"/>
<link href="#rfc.section.5.1.2" rel="Chapter" title="5.1.2 Dummy Node"/>
<link href="#rfc.section.5.1.3" rel="Chapter" title="5.1.3 Node Resource Spam"/>
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 Threats and Attacks on Confidentiality"/>
<link href="#rfc.section.5.2.1" rel="Chapter" title="5.2.1 Routing Exchange Exposure"/>
<link href="#rfc.section.5.2.2" rel="Chapter" title="5.2.2 Routing Information (Routes and Network Topology) Exposure"/>
<link href="#rfc.section.6" rel="Chapter" title="6 Threats and Attacks on Integrity"/>
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 Routing Information Manipulation"/>
<link href="#rfc.section.6.2" rel="Chapter" title="6.2 Node Identity Misappropriation"/>
<link href="#rfc.section.7" rel="Chapter" title="7 Threats and Attacks on Availability"/>
<link href="#rfc.section.7.1" rel="Chapter" title="7.1 Routing Exchange Interference or Disruption"/>
<link href="#rfc.section.7.2" rel="Chapter" title="7.2 Network Traffic Forwarding Disruption"/>
<link href="#rfc.section.7.3" rel="Chapter" title="7.3 Communications Resource Disruption"/>
<link href="#rfc.section.7.4" rel="Chapter" title="7.4 Node Resource Exhaustion"/>
<link href="#rfc.section.8" rel="Chapter" title="8 Countermeasures"/>
<link href="#rfc.section.8.1" rel="Chapter" title="8.1 Confidentiality Attack Countermeasures"/>
<link href="#rfc.section.8.1.1" rel="Chapter" title="8.1.1 Countering Deliberate Exposure Attacks"/>
<link href="#rfc.section.8.1.2" rel="Chapter" title="8.1.2 Countering Sniffing Attacks"/>
<link href="#rfc.section.8.1.3" rel="Chapter" title="8.1.3 Countering Traffic Analysis"/>
<link href="#rfc.section.8.1.4" rel="Chapter" title="8.1.4 Countering Remote Device Access Attacks"/>
<link href="#rfc.section.8.2" rel="Chapter" title="8.2 Integrity Attack Countermeasures"/>
<link href="#rfc.section.8.2.1" rel="Chapter" title="8.2.1 Countering Unauthorized Modification Attacks"/>
<link href="#rfc.section.8.2.2" rel="Chapter" title="8.2.2 Countering Overclaiming and Misclaiming Attacks"/>
<link href="#rfc.section.8.2.3" rel="Chapter" title="8.2.3 Countering Identity (including Sybil) Attacks"/>
<link href="#rfc.section.8.2.4" rel="Chapter" title="8.2.4 Countering Routing Information Replay Attacks"/>
<link href="#rfc.section.8.2.5" rel="Chapter" title="8.2.5 Countering Byzantine Routing Information Attacks"/>
<link href="#rfc.section.8.3" rel="Chapter" title="8.3 Availability Attack Countermeasures"/>
<link href="#rfc.section.8.3.1" rel="Chapter" title="8.3.1 Countering HELLO Flood Attacks and ACK Spoofing Attacks"/>
<link href="#rfc.section.8.3.2" rel="Chapter" title="8.3.2 Countering Overload Attacks"/>
<link href="#rfc.section.8.3.3" rel="Chapter" title="8.3.3 Countering Selective Forwarding Attacks"/>
<link href="#rfc.section.8.3.4" rel="Chapter" title="8.3.4 Countering Sinkhole Attacks"/>
<link href="#rfc.section.8.3.5" rel="Chapter" title="8.3.5 Countering Wormhole Attacks"/>
<link href="#rfc.section.9" rel="Chapter" title="9 ROLL Security Features"/>
<link href="#rfc.section.9.1" rel="Chapter" title="9.1 Confidentiality Features"/>
<link href="#rfc.section.9.2" rel="Chapter" title="9.2 Integrity Features"/>
<link href="#rfc.section.9.3" rel="Chapter" title="9.3 Availability Features"/>
<link href="#rfc.section.9.4" rel="Chapter" title="9.4 Key Management"/>
<link href="#rfc.section.9.5" rel="Chapter" title="9.5 Consideration on Matching Application Domain Needs"/>
<link href="#rfc.section.9.5.1" rel="Chapter" title="9.5.1 Security Architecture"/>
<link href="#rfc.section.9.5.2" rel="Chapter" title="9.5.2 Mechanisms and Operations"/>
<link href="#rfc.section.10" rel="Chapter" title="10 IANA Considerations"/>
<link href="#rfc.section.11" rel="Chapter" title="11 Security Considerations"/>
<link href="#rfc.section.12" rel="Chapter" title="12 Acknowledgments"/>
<link href="#rfc.references" rel="Chapter" title="13 References"/>
<link href="#rfc.references.1" rel="Chapter" title="13.1 Normative References"/>
<link href="#rfc.references.2" rel="Chapter" title="13.2 Informative References"/>
<link href="#rfc.authors" rel="Chapter"/>


  <meta name="generator" content="xml2rfc version 2.4.2 - http://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Tsao, T., Alexander, R., Dohler, M., Daza, V., and A. Lozano" />
  <meta name="dct.identifier" content="urn:ietf:id:draft-ietf-roll-security-threats-04" />
  <meta name="dct.issued" scheme="ISO8601" content="2013-9-03" />
  <meta name="dct.abstract" content="This document presents a security threat analysis for routing over low-power and lossy networks (LLN). The development builds upon previous work on routing security and adapts the assessments to the issues and constraints specific to low-power and lossy networks. A systematic approach is used in defining and evaluating the security threats. Applicable countermeasures are application specific and are addressed in relevant applicability statements. These assessments provide the basis of the security recommendations for incorporation into low-power, lossy network routing protocols." />
  <meta name="description" content="This document presents a security threat analysis for routing over low-power and lossy networks (LLN). The development builds upon previous work on routing security and adapts the assessments to the issues and constraints specific to low-power and lossy networks. A systematic approach is used in defining and evaluating the security threats. Applicable countermeasures are application specific and are addressed in relevant applicability statements. These assessments provide the basis of the security recommendations for incorporation into low-power, lossy network routing protocols." />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
  <td class="left">Networking Working Group</td>
  <td class="right">T. Tsao</td>
</tr>
<tr>
  <td class="left">Internet-Draft</td>
  <td class="right">R. Alexander</td>
</tr>
<tr>
  <td class="left">Intended status: Informational</td>
  <td class="right">Cooper Power Systems</td>
</tr>
<tr>
  <td class="left">Expires: March 07, 2014</td>
  <td class="right">M. Dohler</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">CTTC</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">V. Daza</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">A. Lozano</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">Universitat Pompeu Fabra</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">September 03, 2013</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">A Security Threat Analysis for Routing over Low-Power and Lossy Networks<br />
  <span class="filename">draft-ietf-roll-security-threats-04</span></p>
  
  <h1 id="rfc.abstract">
  <a href="#rfc.abstract">Abstract</a>
</h1>
<p>This document presents a security threat analysis for routing over low-power and lossy networks (LLN). The development builds upon previous work on routing security and adapts the assessments to the issues and constraints specific to low-power and lossy networks. A systematic approach is used in defining and evaluating the security threats. Applicable countermeasures are application specific and are addressed in relevant applicability statements. These assessments provide the basis of the security recommendations for incorporation into low-power, lossy network routing protocols.</p>
<h1>
  <a>Requirements Language</a>
</h1>
<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">RFC 2119</a> <cite title="NONE">[RFC2119]</cite>.</p>
<h1 id="rfc.status">
  <a href="#rfc.status">Status of This Memo</a>
</h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on March 07, 2014.</p>
<h1 id="rfc.copyrightnotice">
  <a href="#rfc.copyrightnotice">Copyright Notice</a>
</h1>
<p>Copyright (c) 2013 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a></li>
<li>2.   <a href="#rfc.section.2">Terminology</a></li>
<li>3.   <a href="#rfc.section.3">Considerations on ROLL Security</a></li>
<li>3.1.   <a href="#rfc.section.3.1">Routing Assets and Points of Access</a></li>
<li>3.2.   <a href="#rfc.section.3.2">The ISO 7498-2 Security Reference Model</a></li>
<li>3.3.   <a href="#rfc.section.3.3">Issues Specific to or Amplified in LLNs</a></li>
<li>3.4.   <a href="#rfc.section.3.4">ROLL Security Objectives</a></li>
<li>4.   <a href="#rfc.section.4">Threat Sources</a></li>
<li>5.   <a href="#rfc.section.5">Threats and Attacks</a></li>
<li>5.1.   <a href="#rfc.section.5.1">Threats due to failures to Authenticate</a></li>
<li>5.1.1.   <a href="#rfc.section.5.1.1">Node Impersonation</a></li>
<li>5.1.2.   <a href="#rfc.section.5.1.2">Dummy Node</a></li>
<li>5.1.3.   <a href="#rfc.section.5.1.3">Node Resource Spam</a></li>
<li>5.2.   <a href="#rfc.section.5.2">Threats and Attacks on Confidentiality</a></li>
<li>5.2.1.   <a href="#rfc.section.5.2.1">Routing Exchange Exposure</a></li>
<li>5.2.2.   <a href="#rfc.section.5.2.2">Routing Information (Routes and Network Topology) Exposure</a></li>
<li>6.   <a href="#rfc.section.6">Threats and Attacks on Integrity</a></li>
<li>6.1.   <a href="#rfc.section.6.1">Routing Information Manipulation</a></li>
<li>6.2.   <a href="#rfc.section.6.2">Node Identity Misappropriation</a></li>
<li>7.   <a href="#rfc.section.7">Threats and Attacks on Availability</a></li>
<li>7.1.   <a href="#rfc.section.7.1">Routing Exchange Interference or Disruption</a></li>
<li>7.2.   <a href="#rfc.section.7.2">Network Traffic Forwarding Disruption</a></li>
<li>7.3.   <a href="#rfc.section.7.3">Communications Resource Disruption</a></li>
<li>7.4.   <a href="#rfc.section.7.4">Node Resource Exhaustion</a></li>
<li>8.   <a href="#rfc.section.8">Countermeasures</a></li>
<li>8.1.   <a href="#rfc.section.8.1">Confidentiality Attack Countermeasures</a></li>
<li>8.1.1.   <a href="#rfc.section.8.1.1">Countering Deliberate Exposure Attacks</a></li>
<li>8.1.2.   <a href="#rfc.section.8.1.2">Countering Sniffing Attacks</a></li>
<li>8.1.3.   <a href="#rfc.section.8.1.3">Countering Traffic Analysis</a></li>
<li>8.1.4.   <a href="#rfc.section.8.1.4">Countering Remote Device Access Attacks</a></li>
<li>8.2.   <a href="#rfc.section.8.2">Integrity Attack Countermeasures</a></li>
<li>8.2.1.   <a href="#rfc.section.8.2.1">Countering Unauthorized Modification Attacks</a></li>
<li>8.2.2.   <a href="#rfc.section.8.2.2">Countering Overclaiming and Misclaiming Attacks</a></li>
<li>8.2.3.   <a href="#rfc.section.8.2.3">Countering Identity (including Sybil) Attacks</a></li>
<li>8.2.4.   <a href="#rfc.section.8.2.4">Countering Routing Information Replay Attacks</a></li>
<li>8.2.5.   <a href="#rfc.section.8.2.5">Countering Byzantine Routing Information Attacks</a></li>
<li>8.3.   <a href="#rfc.section.8.3">Availability Attack Countermeasures</a></li>
<li>8.3.1.   <a href="#rfc.section.8.3.1">Countering HELLO Flood Attacks and ACK Spoofing Attacks</a></li>
<li>8.3.2.   <a href="#rfc.section.8.3.2">Countering Overload Attacks</a></li>
<li>8.3.3.   <a href="#rfc.section.8.3.3">Countering Selective Forwarding Attacks</a></li>
<li>8.3.4.   <a href="#rfc.section.8.3.4">Countering Sinkhole Attacks</a></li>
<li>8.3.5.   <a href="#rfc.section.8.3.5">Countering Wormhole Attacks</a></li>
<li>9.   <a href="#rfc.section.9">ROLL Security Features</a></li>
<li>9.1.   <a href="#rfc.section.9.1">Confidentiality Features</a></li>
<li>9.2.   <a href="#rfc.section.9.2">Integrity Features</a></li>
<li>9.3.   <a href="#rfc.section.9.3">Availability Features</a></li>
<li>9.4.   <a href="#rfc.section.9.4">Key Management</a></li>
<li>9.5.   <a href="#rfc.section.9.5">Consideration on Matching Application Domain Needs</a></li>
<li>9.5.1.   <a href="#rfc.section.9.5.1">Security Architecture</a></li>
<li>9.5.2.   <a href="#rfc.section.9.5.2">Mechanisms and Operations</a></li>
<li>10.   <a href="#rfc.section.10">IANA Considerations</a></li>
<li>11.   <a href="#rfc.section.11">Security Considerations</a></li>
<li>12.   <a href="#rfc.section.12">Acknowledgments</a></li>
<li>13.   <a href="#rfc.references">References</a></li>
<li>13.1.   <a href="#rfc.references.1">Normative References</a></li>
<li>13.2.   <a href="#rfc.references.2">Informative References</a></li>
<li><a href="#rfc.authors">Authors' Addresses</a></li>


  </ul>

  <h1 id="rfc.section.1"><a href="#rfc.section.1">1.</a> <a href="#intro" id="intro">Introduction</a></h1>
<p id="rfc.section.1.p.1">In recent times, networked electronic devices have found an increasing number of applications in various fields. Yet, for reasons ranging from operational application to economics, these wired and wireless devices are often supplied with minimum physical resources; the constraints include those on computational resources (RAM, clock speed, storage), communication resources (duty cycle, packet size, etc.), but also form factors that may rule out user access interfaces (e.g., the housing of a small stick-on switch), or simply safety considerations (e.g., with gas meters). As a consequence, the resulting networks are more prone to loss of traffic and other vulnerabilities. The proliferation of these low-power and lossy networks (LLNs), however, are drawing efforts to examine and address their potential networking challenges. Securing the establishment and maintenance of network connectivity among these deployed devices becomes one of these key challenges.</p>
<p id="rfc.section.1.p.2">This document presents a threat analysis for securing Routing Over LLNs (ROLL) through an analysis that starts from the routing basics.  The process requires two steps.  First, the analysis will be used to identify pertinent security issues.  The second step is to identify necessary countermeasures to secure the ROLL protocols.  As there are multiple ways to solve the problem and the specific tradeoffs are deployment specific, the specific countermeasure to be used is detailed in applicatbility statements.</p>
<p id="rfc.section.1.p.3">This document uses [IS07498-2] model, which includes Authentication, Access Control, Data Confidentiality, Data Integrity, and Non-Repudiation but to which Availability is added.</p>
<p id="rfc.section.1.p.4">All of this document concerns itself with control plane traffic only.</p>
<h1 id="rfc.section.2"><a href="#rfc.section.2">2.</a> Terminology</h1>
<p id="rfc.section.2.p.1">This document adopts the terminology defined in <a href="#RFC6550">[RFC6550]</a>, in <a href="#RFC4949">[RFC4949]</a>, and in <a href="#I-D.ietf-roll-terminology">[I-D.ietf-roll-terminology]</a>.  </p>
<h1 id="rfc.section.3"><a href="#rfc.section.3">3.</a> <a href="#cons-on-roll-sec" id="cons-on-roll-sec">Considerations on ROLL Security</a></h1>
<p id="rfc.section.3.p.1">Routing security, in essence, ensures that the routing protocol operates correctly. It entails implementing measures to ensure controlled state changes on devices and network elements, both based on external inputs (received via communications) or internal inputs (physical security of device itself and parameters maintained by the device, including, e.g., clock). State changes would thereby involve not only authorization of injector's actions, authentication of injectors, and potentially confidentiality of routing data, but also proper order of state changes through timeliness, since seriously delayed state changes, such as commands or updates of routing tables, may negatively impact system operation. A security assesment can therefore begin with a focus on the assets <a href="#RFC4949">[RFC4949]</a> that may be the target of the state changes and the access points in terms of interfaces and protocol exchanges through which such changes may occur. In the case of routing security the focus is directed towards the elements associated with the establishment and maintenance of network connectivity.</p>
<p id="rfc.section.3.p.2">This section sets the stage for the development of the analysis by applying the systematic approach proposed in <a href="#Myagmar2005">[Myagmar2005]</a> to the routing security, while also drawing references from other reviews and assessments found in the literature, particularly, <a href="#RFC4593">[RFC4593]</a> and <a href="#Karlof2003">[Karlof2003]</a>.  The subsequent subsections begin with a focus on the elements of a generic routing process that is used to establish routing assets and points of access to the routing functionality. Next, the <a href="#ISO.7498-2.1988">[ISO.7498-2.1988]</a> security model is briefly described. Then, consideration is given to issues specific to or amplified in LLNs. This section concludes with the formulation of a set of security objectives for ROLL.</p>
<h1 id="rfc.section.3.1"><a href="#rfc.section.3.1">3.1.</a> <a href="#routing-assets" id="routing-assets">Routing Assets and Points of Access</a></h1>
<p id="rfc.section.3.1.p.1">An asset is an important system resource (including information, process, or physical resource), the access to, corruption or loss of which adversely affects the system. In the control plane context, an asset is information about the network, processes used to manage and manipulate this data, and the physical devices on which this data is stored and manipulated. The corruption or loss of these assets may adversely impact the control plane of the network. Within the same context, a point of access is an interface or protocol that facilitates interaction between control plane components. Identifying these assets and points of access will provide a basis for enumerating the attack surface of the control plane.</p>
<p id="rfc.section.3.1.p.2">A level-0 data flow diagram <a href="#Yourdon1979">[Yourdon1979]</a> is used here to identify the assets and points of access within a generic routing process. The use of a data flow diagram allows for a clear and concise model of the way in which routing nodes interact and process information, and hence provides a context for threats and attacks. The goal of the model is to be as detailed as possible so that corresponding assets, points of access, and process in an individual routing protocol can be readily identified.</p>
<p><a href="#Fig1">Figure 1</a> shows that nodes participating in the routing process transmit messages to discover neighbors and to exchange routing information; routes are then generated and stored, which may be maintained in the form of the protocol forwarding table. The nodes use the derived routes for making forwarding decisions.</p>
<div id="rfc.figure.1"/>
<div id="Fig1"/>
<p/>
<pre>
            
                 ...................................................
                 :                                                 :
                 :                                                 :
     |Node_i|&lt;-------&gt;(Routing Neighbor       _________________    :
                 :     Discovery)------------&gt;Neighbor Topology    :
                 :                            -------+---------    :
                 :                                   |             :
     |Node_j|&lt;-------&gt;(Route/Topology       +--------+             :
                 :     Exchange)            |                      :
                 :           |              V            ______    :
                 :           +----&gt;(Route Generation)---&gt;Routes    :
                 :                                       ---+--    :
                 :                                          |      :
                 : Routing on a Node Node_k                 |      :
                 ...................................................
                                                            |
     |Forwarding                                            |
     |On Node_l|&lt;-------------------------------------------+


Notation:

(Proc)     A process Proc

________
DataBase   A data storage DataBase
--------

|Node_n|   An external entity Node_n

-------&gt;   Data flow

            
          </pre>
<p/>
<p class="figure">Figure 1: Data Flow Diagram of a Generic Routing Process</p>
<p id="rfc.section.3.1.p.4">It is seen from <a href="#Fig1">Figure 1</a> that </p>

<ul>
  <li>Assets include<ul><li>routing and/or topology information;</li><li>route generation process;</li><li>communication channel resources (bandwidth);</li><li>node resources (computing capacity, memory, and remaining energy);</li><li>node identifiers (including node identity and ascribed attributes such as relative or absolute node location).</li></ul></li>
  <li>Points of access include<ul><li>neighbor discovery;</li><li>route/topology exchange;</li><li>node physical interfaces (including access to data storage).</li></ul></li>
</ul>

<p>A focus on the above list of assets and points of access enables a more directed assessment of routing security; for example, it is readily understood that some routing attacks are in the form of attempts to misrepresent routing topology. Indeed, the intention of the security threat analysis is to be comprehensive. Hence, some of the discussion which follows is associated with assets and points of access that are not directly related to routing protocol design but nonetheless provided for reference since they do have direct consequences on the security of routing.</p>
<h1 id="rfc.section.3.2"><a href="#rfc.section.3.2">3.2.</a> <a href="#iso" id="iso">The ISO 7498-2 Security Reference Model</a></h1>
<p id="rfc.section.3.2.p.1">At the conceptual level, security within an information system in general and applied to ROLL in particular is concerned with the primary issues of authentication, access control, data confidentiality, data integrity, and non-repudiation. In the context of ROLL</p>
<p/>

<dl>
  <dt>Authentication</dt>
  <dd style="margin-left: 6"><br/>Authentication involves the mutual authentication of the routing peers prior to exchanging route information (i.e., peer authentication) as well as ensuring that the source of the route data is from the peer (i.e., data origin authentication).  <a href="#RFC5548">[RFC5548]</a> points out that LLNs can be drained by unauthenticated peers before configuration.  <a href="#RFC5673">[RFC5673]</a> requires availability of open and untrusted side channels for new joiners, and it requires strong and automated authentication so that networks can automatically accept or reject new joiners.</dd>
  <dt>Access Control</dt>
  <dd style="margin-left: 6"><br/>Access Control provides protection against unauthorized use of the asset, and deals with the authorization of a node.</dd>
  <dt>Confidentiality</dt>
  <dd style="margin-left: 6"><br/>Confidentiality involves the protection of routing information as well as routing neighbor maintenance exchanges so that only authorized and intended network entities may view or access it. Because LLNs are most commonly found on a publicly accessible shared medium, e.g., air or wiring in a building, and sometimes formed ad hoc, confidentiality also extends to the neighbor state and database information within the routing device since the deployment of the network creates the potential for unauthorized access to the physical devices themselves.</dd>
  <dt>Integrity</dt>
  <dd style="margin-left: 6"><br/>Integrity entails the protection of routing information and routing neighbor maintenance exchanges, as well as derived information maintained in the database, from unauthorized modification, insertions, deletions or replays. to be addressed beyond the routing protocol.</dd>
  <dt>Non-repudiation</dt>
  <dd style="margin-left: 6"><br/>Non-repudiation is the assurance that the transmission and/or reception of a message cannot later be denied. The service of non-repudiation applies after-the-fact and thus relies on the logging or other capture of on-going message exchanges and signatures. Applied to routing, non-repudiation is not an issue because it does not apply to routing protocols, which are machine-to-machine protocols.  Further, with the LLN application domains as described in <a href="#RFC5867">[RFC5867]</a> and <a href="#RFC5548">[RFC5548]</a>, proactive measures are much more critical than retrospective protections. Finally, given the significant practical limits to on-going routing transaction logging and storage and individual device digital signature verification for each exchange, non-repudiation in the context of routing is an unsupportable burden that bears no further considered as a ROLL security issue.</dd>
</dl>
<p id="rfc.section.3.2.p.3">It is recognized that, besides those security issues captured in the ISO 7498-2 model, availability, is a security requirement:</p>

<dl>
  <dt>Availability</dt>
  <dd style="margin-left: 6"><br/>Availability ensures that routing information exchanges and forwarding services need to be available when they are required for the functioning of the serving network. Availability will apply to maintaining efficient and correct operation of routing and neighbor discovery exchanges (including needed information) and forwarding services so as not to impair or limit the network's central traffic flow function</dd>
</dl>
<p id="rfc.section.3.2.p.4">It should be emphasized here that for ROLL security the above requirements must be complemented by the proper security policies and enforcement mechanisms to ensure that security objectives are met by a given ROLL implementation.</p>
<h1 id="rfc.section.3.3"><a href="#rfc.section.3.3">3.3.</a> <a href="#roll-issues" id="roll-issues">Issues Specific to or Amplified in LLNs</a></h1>
<p id="rfc.section.3.3.p.1">The work <a href="#RFC5548">[RFC5548]</a>, <a href="#RFC5673">[RFC5673]</a>, <a href="#RFC5826">[RFC5826]</a>, and <a href="#RFC5867">[RFC5867]</a> have identified specific issues and constraints of routing in LLNs for the urban, industrial, home automation, and building automation application domains, respectively. The following is a list of observations and evaluation of their impact on routing security considerations.</p>
<p/>

<dl>
  <dt>Limited energy, memory, and processing node resources</dt>
  <dd style="margin-left: 6"><br/>As a consequence of these constraints, there is an even more critical need than usual for a careful study of trade-offs on which and what level of security services are to be afforded during the system design process. The chosen security mechanisms also needs to work within these constraints. Synchronization of security states with sleepy nodes is yet another issue.</dd>
  <dt>Large scale of rolled out network</dt>
  <dd style="margin-left: 6"><br/>The possibly numerous nodes to be deployed make manual on-site configuration unlikely. For example, an urban deployment can see several hundreds of thousands of nodes being installed by many installers with a low level of expertise.  Nodes may be installed and not activated for many years, and additional nodes may be added later on, which may be from old inventory. The lifetime of the network is measured in decades, and this complicates the operation of key management.</dd>
  <dt>Autonomous operations</dt>
  <dd style="margin-left: 6"><br/>Self-forming and self-organizing are commonly prescribed requirements of LLNs. In other words, a routing protocol designed for LLNs needs to contain elements of ad hoc networking and in most cases cannot rely on manual configuration for initialization or local filtering rules.  Network topology/ownership changes, partitioning or merging, as well as node replacement, can all contribute to complicating the operations of key management.</dd>
  <dt>Highly directional traffic</dt>
  <dd style="margin-left: 6"><br/>Some types of LLNs see a high percentage of their total traffic traverse between the nodes and the LLN Border Routers (LBRs) where the LLNs connect to non-LLNs. The special routing status of and the greater volume of traffic near the LBRs have routing security consequences as a higher valued attack target. In fact, when Point-to-MultiPoint (P2MP) and MultiPoint-to-Point (MP2P) traffic represents a majority of the traffic, routing attacks consisting of advertising incorrect preferred routes can cause serious damage.</dd>
  <dt>Unattended locations and limited physical security</dt>
  <dd style="margin-left: 6"><br/>Many applications have the nodes deployed in unattended or remote locations; furthermore, the nodes themselves are often built with minimal physical protection. These constraints lower the barrier of accessing the data or security material stored on the nodes through physical means.</dd>
  <dt>Support for mobility</dt>
  <dd style="margin-left: 6"><br/>On the one hand, only a limited number of applications require the support of mobile nodes, e.g., a home LLN that includes nodes on wearable health care devices or an industry LLN that includes nodes on cranes and vehicles. On the other hand, if a routing protocol is indeed used in such applications, it will clearly need to have corresponding security mechanisms.</dd>
  <dt></dt>
  <dd style="margin-left: 6">Additionally nodes may appear to move from one side of a wall to another without any actual motion involved, the result of changes to electromagnetic properties, such as opening and closing of a metal door. </dd>
  <dt>Support for multicast and anycast</dt>
  <dd style="margin-left: 6"><br/>Support for multicast and anycast is called out chiefly for large-scale networks. Since application of these routing mechanisms in autonomous operations of many nodes is new, the consequence on security requires careful consideration.</dd>
</dl>
<p id="rfc.section.3.3.p.3">The above list considers how an LLN's physical constraints, size, operations, and variety of application areas may impact security.  However, it is the combinations of these factors that particularly stress the security concerns. For instance, securing routing for a large number of autonomous devices that are left in unattended locations with limited physical security presents challenges that are not found in the common circumstance of administered networked routers. The following subsection sets up the security objectives for the routing protocol designed by the ROLL WG.</p>
<h1 id="rfc.section.3.4"><a href="#rfc.section.3.4">3.4.</a> <a href="#roll-objs" id="roll-objs">ROLL Security Objectives</a></h1>
<p id="rfc.section.3.4.p.1">This subsection applies the ISO 7498-2 model to routing assets and access points, taking into account the LLN issues, to develop a set of ROLL security objectives.</p>
<p id="rfc.section.3.4.p.2">Since the fundamental function of a routing protocol is to build routes for forwarding packets, it is essential to ensure that: </p>

<ul>
  <li>routing/topology information iintegrity remains intact during transfer and in storage;</li>
  <li>routing/topology information is used by authorized entities;</li>
  <li>routing/topology information is available when needed.</li>
</ul>

<p> In conjunction, it is necessary to be assured that </p>

<ul>
  <li>authorized peers authenticate themselves during the routing neighbor discovery process;</li>
  <li>the routing/topology information received is generated according to the protocol design.</li>
</ul>

<p> However, when trust cannot be fully vested through authentication of the principals alone, i.e., concerns of insider attack, assurance of the truthfulness and timeliness of the received routing/topology information is necessary. With regard to confidentiality, protecting the routing/topology information from unauthorized exposure may be desirable in certain cases but is in itself less pertinent in general to the routing function.</p>
<p id="rfc.section.3.4.p.3">One of the main problems of synchronizing security states of sleepy nodes, as listed in the last subsection, lies in difficulties in authentication; these nodes may not have received in time the most recent update of security material. Similarly, the issues of minimal manual configuration, prolonged rollout and delayed addition of nodes, and network topology changes also complicate key management. Hence, routing in LLNs needs to bootstrap the authentication process and allow for flexible expiration scheme of authentication credentials.</p>
<p id="rfc.section.3.4.p.4">The vulnerability brought forth by some special-function nodes, e.g., LBRs, requires the assurance, particularly in a security context, </p>

<ul>
  <li>of the availability of communication channels and node resources;</li>
  <li>that the neighbor discovery process operates without undermining routing availability.</li>
</ul>
<p id="rfc.section.3.4.p.5">There are other factors which are not part of a ROLL protocol but directly affecting its function. These factors include weaker barrier of accessing the data or security material stored on the nodes through physical means; therefore, the internal and external interfaces of a node need to be adequate for guarding the integrity, and possibly the confidentiality, of stored information, as well as the integrity of routing and route generation processes.</p>
<p id="rfc.section.3.4.p.6">Each individual system's use and environment will dictate how the above objectives are applied, including the choices of security services as well as the strengths of the mechanisms that must be implemented. The next two sections take a closer look at how the ROLL security objectives may be compromised and how those potential compromises can be countered.</p>
<h1 id="rfc.section.4"><a href="#rfc.section.4">4.</a> <a href="#threat-sources" id="threat-sources">Threat Sources</a></h1>
<p><a href="#RFC4593">[RFC4593]</a> provides a detailed review of the threat sources: outsiders and byzantine. ROLL has the same threat sources.</p>
<h1 id="rfc.section.5"><a href="#rfc.section.5">5.</a> <a href="#roll-threats" id="roll-threats">Threats and Attacks</a></h1>
<p id="rfc.section.5.p.1">This section outlines general categories of threats under the ISO 7498-2 model and highlights the specific attacks in each of these categories for ROLL. As defined in <a href="#RFC4949">[RFC4949]</a>, a threat is "a potential for violation of security, which exists when there is a circumstance, capability, action, or event that could breach security and cause harm."</p>
<p id="rfc.section.5.p.2">An attack is "an assault on system security that derives from an intelligent threat, i.e., an intelligent act that is a deliberate attempt (especially in the sense of a method or technique) to evade security services and violate the security policy of a system." </p>
<p id="rfc.section.5.p.3">The subsequent subsections consider the threats and the attacks that can cause security breaches under the ISO 7498-2 model to the routing assets and via the routing points of access identified in <a href="#routing-assets">Section 3.1</a>. The assessment steps through the security concerns of each routing asset and looks at the attacks that can exploit routing points of access. The threats and attacks identified are based on the routing model analysis and associated review of the existing literature. The source of the attacks is assumed to be from either inside or outside attackers. The capability these attackes may be limited to node-equivalent, but also to more sophisticated computing platforms.</p>
<h1 id="rfc.section.5.1"><a href="#rfc.section.5.1">5.1.</a> <a href="#authorization-threat" id="authorization-threat">Threats due to failures to Authenticate</a></h1>
<h1 id="rfc.section.5.1.1"><a href="#rfc.section.5.1.1">5.1.1.</a> <a href="#any-identity" id="any-identity">Node Impersonation</a></h1>
<p id="rfc.section.5.1.1.p.1">If an attacker can join a network with any identify, then it may be able to assume the role of a legitimate (and existing node).  It may be able to report false readings (in metering applications), or provide inappropriate control messages (in control systems involving actuators) if the security of the application is leveraged from the security of the routing system.</p>
<p id="rfc.section.5.1.1.p.2">In other systems where there is separate application layer security, the ability to impersonate a node would permit an attacker to direct traffic to itself, which facilitates on-path attacks including replaying, delaying, or duplicating control messages.  </p>
<h1 id="rfc.section.5.1.2"><a href="#rfc.section.5.1.2">5.1.2.</a> <a href="#extra-node" id="extra-node">Dummy Node</a></h1>
<p id="rfc.section.5.1.2.p.1">If an attacker can join a network with any identify, then it can pretend to be a legitimate node, receiving any service legitimate nodes receive.  It may also be able to report false readings (in metering applications), or provide inappropriate authorizations (in control systems involving actuators), or perform any other attacks that are facilitated by being able to direct traffic towards itself.  </p>
<h1 id="rfc.section.5.1.3"><a href="#rfc.section.5.1.3">5.1.3.</a> <a href="#spam-resource" id="spam-resource">Node Resource Spam</a></h1>
<p id="rfc.section.5.1.3.p.1">If an attacker can join a network with any identify, then it can continously do so, draining down the resources of the network to store identity and routing information, potentionally forcing legitimate nodes of the network.</p>
<h1 id="rfc.section.5.2"><a href="#rfc.section.5.2">5.2.</a> <a href="#confident-threat" id="confident-threat">Threats and Attacks on Confidentiality</a></h1>
<p id="rfc.section.5.2.p.1">The assessment in <a href="#iso">Section 3.2</a> indicates that there are threat actions against the confidentiality of routing information at all points of access. The confidentiality threat consequences is disclosure, see Section 3.1.2 of <a href="#RFC4593">[RFC4593]</a>. For ROLL this is the disclosure of routing information either by evesdropping on the communication exchanges between routing nodes or by direct access of node's information.</p>
<h1 id="rfc.section.5.2.1"><a href="#rfc.section.5.2.1">5.2.1.</a> <a href="#route-exch-expo" id="route-exch-expo">Routing Exchange Exposure</a></h1>
<p id="rfc.section.5.2.1.p.1">Routing exchanges include both routing information as well as information associated with the establishment and maintenance of neighbor state information. As indicated in <a href="#routing-assets">Section 3.1</a>, the associated routing information assets may also include device specific resource information, such as memory, remaining power, etc., that may be metrics of the routing protocol.</p>
<p id="rfc.section.5.2.1.p.2">The routing exchanges will contain reachability information, which would identify the relative importance of different nodes in the network.  Nodes higher up in the DODAG, to which more streams of information flow, would be more interesting targets for other attacks, and routing exchange exposures can identify them.  </p>
<h1 id="rfc.section.5.2.2"><a href="#rfc.section.5.2.2">5.2.2.</a> <a href="#route-info-expo" id="route-info-expo">Routing Information (Routes and Network Topology) Exposure</a></h1>
<p id="rfc.section.5.2.2.p.1">Routes (which may be maintained in the form of the protocol forwarding table) and neighbor topology information are the products of the routing process that are stored within the node device databases.</p>
<p id="rfc.section.5.2.2.p.2">The exposure of this information will allow attachers to gain direct access to the configuration and connectivity of the network thereby exposing routing to targeted attacks on key nodes or links.  Since routes and neighbor topology information is stored within the node device, threats or attacks on the confidentiality of the information will apply to the physical device including specified and unspecified internal and external interfaces.</p>
<p id="rfc.section.5.2.2.p.3">The forms of attack that allow unauthorized access or disclosure of the routing information (other than occurring through explicit node exchanges) will include: </p>

<ul>
  <li>Physical device compromise;</li>
  <li>Remote device access attacks (including those occurring through remote network management or software/field upgrade interfaces).</li>
</ul>

<p> </p>
<p id="rfc.section.5.2.2.p.4">Both of these attack vectors are considered a device specific issue, and are out of scope for the RPL protocol to defend against.  In some applications, physical device compromise may be a real threat and it may be necessary to provide for other devices to react quickly to exclude a compromised device.  </p>
<h1 id="rfc.section.6"><a href="#rfc.section.6">6.</a> <a href="#integ-threat" id="integ-threat">Threats and Attacks on Integrity</a></h1>
<p id="rfc.section.6.p.1">The assessment in <a href="#iso">Section 3.2</a> indicates that information and identity assets are exposed to integrity threats from all points of access. In other words, the integrity threat space is defined by the potential for exploitation introduced by access to assets available through routing exchanges and the on-device storage.</p>
<h1 id="rfc.section.6.1"><a href="#rfc.section.6.1">6.1.</a> <a href="#manipul" id="manipul">Routing Information Manipulation</a></h1>
<p id="rfc.section.6.1.p.1">Manipulation of routing information that range from neighbor states to derived routes will allow unauthorized sources to influence the operation and convergence of the routing protocols and ultimately impact the forwarding decisions made in the network.  </p>
<p id="rfc.section.6.1.p.2">Manipulation of topology and reachability information will allow unauthorized sources to influence the nodes with which routing information is exchanged and updated. The consequence of manipulating routing exchanges can thus lead to sub-optimality and fragmentation or partitioning of the network by restricting the universe of routers with which associations can be established and maintained.  </p>
<p id="rfc.section.6.1.p.3">A sub-optimal network may use too much power and/or may congest some routes leading to premature failure of a node, and a denial of service on the entire network.  </p>
<p id="rfc.section.6.1.p.4">In addition, being able to attract network traffic can make a blackhole attack more damaging.  </p>
<p id="rfc.section.6.1.p.5">The forms of attack that allow manipulation to compromise the content and validity of routing information include</p>

<ul>
  <li>Falsification, including overclaiming and misclaiming;</li>
  <li>Routing information replay;</li>
  <li>Byzantine (internal) attacks that permit corruption of routing information in the node even where the node continues to be a validated entity within the network (see, for example, <a href="#RFC4593">[RFC4593]</a> for further discussions on Byzantine attacks);</li>
  <li>Physical device compromise or remote device access attacks.</li>
</ul>
<h1 id="rfc.section.6.2"><a href="#rfc.section.6.2">6.2.</a> <a href="#id-misappr" id="id-misappr">Node Identity Misappropriation</a></h1>
<p id="rfc.section.6.2.p.1">Falsification or misappropriation of node identity between routing participants opens the door for other attacks; it can also cause incorrect routing relationships to form and/or topologies to emerge. Routing attacks may also be mounted through less sophisticated node identity misappropriation in which the valid information broadcast or exchanged by a node is replayed without modification. The receipt of seemingly valid information that is however no longer current can result in routing disruption, and instability (including failure to converge). Without measures to authenticate the routing participants and to ensure the freshness and validity of the received information the protocol operation can be compromised. The forms of attack that misuse node identity include</p>

<ul>
  <li>Identity attacks, including Sybil attacks in which a malicious node illegitimately assumes multiple identities;</li>
  <li>Routing information replay.</li>
</ul>
<h1 id="rfc.section.7"><a href="#rfc.section.7">7.</a> <a href="#avail-threat" id="avail-threat">Threats and Attacks on Availability</a></h1>
<p id="rfc.section.7.p.1">The assessment in <a href="#iso">Section 3.2</a> indicates that the process and resources assets are exposed to threats against availability; attacks in this category may exploit directly or indirectly information exchange or forwarding (see <a href="#RFC4732">[RFC4732]</a> for a general discussion).</p>
<h1 id="rfc.section.7.1"><a href="#rfc.section.7.1">7.1.</a> <a href="#route-exch-intrpt" id="route-exch-intrpt">Routing Exchange Interference or Disruption</a></h1>
<p id="rfc.section.7.1.p.1">Interference is the threat action and disruption is threat consequence that allows attackers to influence the operation and convergence of the routing protocols by impeding the routing information exchange.</p>
<p id="rfc.section.7.1.p.2">The forms of attack that allow interference or disruption of routing exchange include:</p>

<ul>
  <li>Routing information replay;</li>
  <li>ACK spoofing;</li>
  <li>Overload attacks.</li>
</ul>
<p id="rfc.section.7.1.p.3">In addition, attacks may also be directly conducted at the physical layer in the form of jamming or interfering.</p>
<h1 id="rfc.section.7.2"><a href="#rfc.section.7.2">7.2.</a> <a href="#disrupt-forward" id="disrupt-forward">Network Traffic Forwarding Disruption</a></h1>
<p id="rfc.section.7.2.p.1">The disruption of the network traffic forwarding capability will undermine the central function of network routers and the ability to handle user traffic. This affects the availability of the network because of the potential to impair the primary capability of the network.</p>
<div id="rfc.figure.2"/>
<div id="Fig2"/>
<p id="rfc.section.7.2.p.2">In addition to physical layer obstructions, the forms of attack that allows disruption of network traffic forwarding include <a href="#Karlof2003">[Karlof2003]</a></p>

<p/>
<pre>
            
|Node_1|--(msg1|msg2|msg3)--&gt;|Attacker|--(msg1|msg3)--&gt;|Node_2|

(a) Selective Forwarding
                        </pre>
<p/>
<p class="figure">Figure 2: Selective Forwarding</p>
<div id="rfc.figure.3"/>
<div id="Fig3"/>
<p/>
<pre>
            
|Node_1|-------------Unreachable---------x|Node_2|
   |                                         ^
   |               Private Link              |
   '--&gt;|Attacker_1|===========&gt;|Attacker_2|--'


(b) Wormhole
                        </pre>
<p/>
<p class="figure">Figure 3: Wormhole Attacks</p>
<div id="rfc.figure.4"/>
<div id="Fig4"/>
<p/>
<pre>
            
|Node_1|     |Node_4|
    |            |
    `--------.   |
Falsify as    \  |
Good Link \   |  |
To Node_5  \  |  |
            \ V  V
|Node_2|--&gt;|Attacker|--Not Forwarded---x|Node_5|
              ^  ^ \
              |  |  \ Falsify as
              |  |   \Good Link
              /  |    To Node_5
     ,-------'   |
     |           |
|Node_3|     |Node_i|

(c) Sinkhole

                        </pre>
<p/>
<p class="figure">Figure 4: Selective Forwarding, Wormhole, and Sinkhole Attacks</p>
<ul>
  <li>Selective forwarding attacks; </li>
  <li>Wormhole attacks; </li>
  <li>Sinkhole attacks.  </li>
</ul>
<h1 id="rfc.section.7.3"><a href="#rfc.section.7.3">7.3.</a> <a href="#disrpt-comm-resourse" id="disrpt-comm-resourse">Communications Resource Disruption</a></h1>
<p id="rfc.section.7.3.p.1">Attacks mounted against the communication channel resource assets needed by the routing protocol can be used as a means of disrupting its operation. However, while various forms of Denial of Service (DoS) attacks on the underlying transport subsystem will affect routing protocol exchanges and operation (for example physical layer RF jamming in a wireless network or link layer attacks), these attacks cannot be countered by the routing protocol. As such, the threats to the underlying transport network that supports routing is considered beyond the scope of the current document. Nonetheless, attacks on the subsystem will affect routing operation and so must be directly addressed within the underlying subsystem and its implemented protocol layers.</p>
<h1 id="rfc.section.7.4"><a href="#rfc.section.7.4">7.4.</a> <a href="#exhaust-resource" id="exhaust-resource">Node Resource Exhaustion</a></h1>
<p id="rfc.section.7.4.p.1">A potential threat consequence can arise from attempts to overload the node resource asset by initiating exchanges that can lead to the exhaustion of processing, memory, or energy resources.  The establishment and maintenance of routing neighbors opens the routing process to engagement and potential acceptance of multiple neighboring peers. Association information must be stored for each peer entity and for the wireless network operation provisions made to periodically update and reassess the associations. An introduced proliferation of apparent routing peers can therefore have a negative impact on node resources.</p>
<p id="rfc.section.7.4.p.2">Node resources may also be unduly consumed by attackers attempting uncontrolled topology peering or routing exchanges, routing replays, or the generating of other data traffic floods.  Beyond the disruption of communications channel resources, these consequences may be able to exhaust node resources only where the engagements are able to proceed with the peer routing entities.  Routing operation and network forwarding functions can thus be adversely impacted by node resources exhaustion that stems from attacks that include:</p>

<ul>
  <li>Identity (including Sybil) attacks;</li>
  <li>Routing information replay attacks;</li>
  <li>HELLO flood attacks;</li>
  <li>Overload attacks.</li>
</ul>
<h1 id="rfc.section.8"><a href="#rfc.section.8">8.</a> <a href="#counter-measur" id="counter-measur">Countermeasures</a></h1>
<p id="rfc.section.8.p.1">By recognizing the characteristics of LLNs that may impact routing, this analysis provides the basis for developing capabilities within ROLL protocols to deter the identified attacks and mitigate the threats. The following subsections consider such countermeasures by grouping the attacks according to the classification of the ISO 7498-2 model so that associations with the necessary security services are more readily visible. However, the considerations here are more systematic than confined to means available only within routing; the next section will then distill and make recommendations appropriate for a secured ROLL protocol.</p>
<h1 id="rfc.section.8.1"><a href="#rfc.section.8.1">8.1.</a> <a href="#counter-confident-atk" id="counter-confident-atk">Confidentiality Attack Countermeasures</a></h1>
<p id="rfc.section.8.1.p.1">Attacks to disclosure routing information may be mounted at the level of the routing information assets, at the points of access associated with routing exchanges between nodes, or through device interface access. To gain access to routing/topology information, the attacker may rely on a compromised node that deliberately exposes the information during the routing exchange process, may rely on passive sniffing or traffic analysis, or may attempt access through a component or device interface of a tampered routing node.</p>
<h1 id="rfc.section.8.1.1"><a href="#rfc.section.8.1.1">8.1.1.</a> Countering Deliberate Exposure Attacks</h1>
<p id="rfc.section.8.1.1.p.1">A deliberate exposure attack is one in which an entity that is party to the routing process or topology exchange allows the routing/topology information or generated route information to be exposed to an unauthorized entity.</p>
<p id="rfc.section.8.1.1.p.2">A prerequisite to countering this attack is to ensure that the communicating nodes are authenticated prior to data encryption applied in the routing exchange. Authentication ensures that the nodes are who they claim to be even though it does not provide an indication of whether the node has been compromised.</p>
<p id="rfc.section.8.1.1.p.3">To mitigate the risk of deliberate exposure, the process that communicating nodes use to establish session keys must be peer-to-peer (i.e., between the routing initiating and responding nodes). This helps ensure that neither node is exchaning routing information with another peer without the knowledge of both communicating peerscan. For a deliberate exposure attack to succeed, the comprised node will need to more overt and take independent actions in order to disclose the routing information to 3rd party.</p>
<p id="rfc.section.8.1.1.p.4">Note that the same measures which apply to securing routing/topology exchanges between operational nodes must also extend to field tools and other devices used in a deployed network where such devices can be configured to participate in routing exchanges.</p>
<h1 id="rfc.section.8.1.2"><a href="#rfc.section.8.1.2">8.1.2.</a> Countering Sniffing Attacks</h1>
<p id="rfc.section.8.1.2.p.1">A sniffing attack seeks to breach routing confidentiality through passive, direct analysis and processing of the information exchanges between nodes. </p>
<p id="rfc.section.8.1.2.p.2">Sniffing attacks can be directly countered through the use of data encryption for all routing exchanges. Only when a validated and authenticated node association is completed will routing exchange be allowed to proceed using established session keys and an agreed encryption algorithm. The strength of the encryption algorithm and session key sizes will determine the minimum requirement for an attacker mounting this passive security attack. The possibility of incorporating options for security level and algorithms is further considered in <a href="#match-needs">Section 9.5</a>. Because of the resource constraints of LLN devices, symmetric (private) key encryption will provide the best trade-off in terms of node and channel resource overhead and the level of security achieved. This will of course not preclude the use of asymmetric (public) key encryption during the session key establishment phase.</p>
<p id="rfc.section.8.1.2.p.3">As with the key establishment process, data encryption must include an authentication prerequisite to ensure that each node is implementing a level of security that prevents deliberate or inadvertent exposure. The authenticated key establishment will ensure that confidentiality is not compromised by providing the information to an unauthorized entity (see also <a href="#Huang2003">[Huang2003]</a>).</p>
<p id="rfc.section.8.1.2.p.4">Based on the current state of the art, a minimum 128-bit key length should be applied where robust confidentiality is demanded for routing protection. This session key shall be applied in conjunction with an encryption algorithm that has been publicly vetted and where applicable approved for the level of security desired. Algorithms such as the Advanced Encryption Standard (AES) <a href="#FIPS197">[FIPS197]</a>, adopted by the U.S. government, or Kasumi-Misty <a href="#Kasumi3gpp">[Kasumi3gpp]</a>, adopted by the 3GPP 3rd generation wireless mobile consortium, are examples of symmetric-key algorithms capable of ensuring robust confidentiality for routing exchanges. The key length, algorithm and mode of operation will be selected as part of the overall security trade-off that also achieves a balance with the level of confidentiality afforded by the physical device in protecting the routing assets.</p>
<p id="rfc.section.8.1.2.p.5">As with any encryption algorithm, the use of ciphering synchronization parameters and limitations to the usage duration of established keys should be part of the security specification to reduce the potential for brute force analysis.</p>
<h1 id="rfc.section.8.1.3"><a href="#rfc.section.8.1.3">8.1.3.</a> Countering Traffic Analysis</h1>
<p id="rfc.section.8.1.3.p.1">Traffic analysis provides an indirect means of subverting confidentiality and gaining access to routing information by allowing an attacker to indirectly map the connectivity or flow patterns (including link-load) of the network from which other attacks can be mounted. The traffic analysis attack on an LLN, especially one founded on shared medium, is passive and relies on the ability to read the immutable source/destination layer-3 routing information that must remain unencrypted to permit network routing.  </p>
<p id="rfc.section.8.1.3.p.2">Alternatively, attacks can be mounted through the injection of unauthorized discovery traffic into the network. By implementing authentication measures between communicating nodes, active traffic analysis attacks can be prevented within the LLN thereby reducing confidentiality vulnerabilities to those associated with passive analysis.  </p>
<p id="rfc.section.8.1.3.p.3">One way in which passive traffic analysis attacks can be muted is through the support of load balancing that allows traffic to a given destination to be sent along diverse routing paths. Where the routing protocol supports load balancing along multiple links at each node, the number of routing permutations in a wide area network surges thus increasing the cost of traffic analysis.  ROLL does not generally support multi-path routing within a single DODAG.  Multiple DODAGs are supported in the protocol, but few deployments will have space for more than half a dozen, and there are at present no clear ways to multiplex traffic for a single application across multiple DODAGs.  </p>
<p id="rfc.section.8.1.3.p.4">Another approach to countering passive traffic analysis could be for nodes to maintain constant amount of traffic to different destinations through the generation of arbitrary traffic flows; the drawback of course would be the consequent overhead. </p>
<p id="rfc.section.8.1.3.p.5">The only means of fully countering a traffic analysis attack is through the use of tunneling (encapsulation) where encryption is applied across the entirety of the original packet source/destination addresses.  Deployments which use layer-2 security that includes encryption already do this for all traffic.  </p>
<h1 id="rfc.section.8.1.4"><a href="#rfc.section.8.1.4">8.1.4.</a> <a href="#counter-remote" id="counter-remote">Countering Remote Device Access Attacks</a></h1>
<p id="rfc.section.8.1.4.p.1">Where LLN nodes are deployed in the field, measures are introduced to allow for remote retrieval of routing data and for software or field upgrades. These paths create the potential for a device to be remotely accessed across the network or through a provided field tool. In the case of network management a node can be directly requested to provide routing tables and neighbor information.</p>
<p id="rfc.section.8.1.4.p.2">To ensure confidentiality of the node routing information against attacks through remote access, any local or remote device requesting routing information must be authenticated to ensure authorized access. Since remote access is not invoked as part of a routing protocol security of routing information stored on the node against remote access will not be addressable as part of the routing protocol.</p>
<h1 id="rfc.section.8.2"><a href="#rfc.section.8.2">8.2.</a> <a href="#counter-integ-atk" id="counter-integ-atk">Integrity Attack Countermeasures</a></h1>
<p id="rfc.section.8.2.p.1">Integrity attack countermeasures address routing information manipulation, as well as node identity and routing information misuse.  Manipulation can occur in the form of falsification attack and physical compromise. To be effective, the following development considers the two aspects of falsification, namely, the unauthorized modifications and the overclaiming and misclaiming content. The countering of physical compromise was considered in the previous section and is not repeated here. With regard to misuse, there are two types of attacks to be deterred, identity attacks and replay attacks.</p>
<h1 id="rfc.section.8.2.1"><a href="#rfc.section.8.2.1">8.2.1.</a> Countering Unauthorized Modification Attacks</h1>
<p id="rfc.section.8.2.1.p.1">Unauthorized modifications may occur in the form of altering the message being transferred or the data stored. Therefore, it is necessary to ensure that only authorized nodes can change the portion of the information that is allowed to be mutable, while the integrity of the rest of the information is protected, e.g., through well-studied cryptographic mechanisms.</p>
<p id="rfc.section.8.2.1.p.2">Unauthorized modifications may also occur in the form of insertion or deletion of messages during protocol changes.  Therefore, the protocol needs to ensure the integrity of the sequence of the exchange sequence.</p>
<p id="rfc.section.8.2.1.p.3">The countermeasure to unauthorized modifications needs to: </p>

<ul>
  <li>implement access control on storage;</li>
  <li>provide data integrity service to transferred messages and stored data;</li>
  <li>include sequence number under integrity protection.</li>
</ul>

<p> </p>
<h1 id="rfc.section.8.2.2"><a href="#rfc.section.8.2.2">8.2.2.</a> Countering Overclaiming and Misclaiming Attacks</h1>
<p id="rfc.section.8.2.2.p.1">Both overclaiming and misclaiming aim to introduce false routes or topology that would not be generated by the network otherwise, while there are not necessarily unauthorized modifications to the routing messages or information. The requisite for a counter is the capability to determine unreasonable routes or topology.</p>
<p id="rfc.section.8.2.2.p.2">The counter to overclaiming and misclaiming may employ: </p>

<ul>
  <li>comparison with historical routing/topology data;</li>
  <li>designs which restrict realizable network topologies.</li>
</ul>

<p> </p>
<h1 id="rfc.section.8.2.3"><a href="#rfc.section.8.2.3">8.2.3.</a> <a href="#counter-sybil" id="counter-sybil">Countering Identity (including Sybil) Attacks</a></h1>
<p id="rfc.section.8.2.3.p.1">Identity attacks, sometimes simply called spoofing, seek to gain or damage assets whose access is controlled through identity. In routing, an identity attacker can illegitimately participate in routing exchanges, distribute false routing information, or cause an invalid outcome of a routing process.</p>
<p id="rfc.section.8.2.3.p.2">A perpetrator of Sybil attacks assumes multiple identities. The result is not only an amplification of the damage to routing, but extension to new areas, e.g., where geographic distribution is explicitly or implicitly an asset to an application running on the LLN, for example, the LBR in a P2MP or MP2P LLN.</p>
<p id="rfc.section.8.2.3.p.3">The countering of identity attacks need to ensure the authenticity and liveliness of the parties of a message exchange.  The means may be through the use of shared key- or public key-based authentication scheme. On the one hand, the large-scale nature of the LLNs makes the network-wide shared key scheme undesirable from a security perspective; on the other hand, public-key based approaches generally require more computational resources. Each system will need to make trade-off decisions based on its security requirements.  As an example, <a href="#Wander2005">[Wander2005]</a> compared the energy consumption between two public-key algorithms on a low-power microcontroller, with reference to a symmetric-key algorithm and a hash algorithm.</p>
<h1 id="rfc.section.8.2.4"><a href="#rfc.section.8.2.4">8.2.4.</a> <a href="#counter-replay" id="counter-replay">Countering Routing Information Replay Attacks</a></h1>
<p id="rfc.section.8.2.4.p.1">In routing, message replay can result in false topology and/or routes. The counter of replay attacks needs to ensure the freshness of the message. On the one hand, there are a number of mechanisms commonly used for countering replay, e.g., with a counter. On the other hand, the choice should take into account how a particular mechanism is made available in an LLN. For example, many LLNs have a central source of time and have it distributed by relaying, such that secured time distribution becomes a prerequisite of using timestamping to counter replay.</p>
<h1 id="rfc.section.8.2.5"><a href="#rfc.section.8.2.5">8.2.5.</a> <a href="#counter-byzantine" id="counter-byzantine">Countering Byzantine Routing Information Attacks</a></h1>
<p id="rfc.section.8.2.5.p.1">Where a node is captured or compromised but continues to operate for a period with valid network security credentials, the potential exists for routing information to be manipulated. This compromise of the routing information could thus exist in spite of security countermeasures that operate between the peer routing devices.</p>
<p id="rfc.section.8.2.5.p.2">Consistent with the end-to-end principle of communications, such an attack can only be fully addressed through measures operating directly between the routing entities themselves or by means of external entities able to access and independently analyze the routing information. Verification of the authenticity and liveliness of the routing entities can therefore only provide a limited counter against internal (Byzantine) node attacks.</p>
<p id="rfc.section.8.2.5.p.3">For link state routing protocols where information is flooded with, for example, areas (OSPF <a href="#RFC2328">[RFC2328]</a>) or levels (ISIS <a href="#RFC1142">[RFC1142]</a>), countermeasures can be directly applied by the routing entities through the processing and comparison of link state information received from different peers.  By comparing the link information from multiple sources decisions can be made by a routing node or external entity with regard to routing information validity; see Chapter 2 of <a href="#Perlman1988">[Perlman1988]</a> for a discussion on flooding attacks.</p>
<p id="rfc.section.8.2.5.p.4">For distance vector protocols where information is aggregated at each routing node it is not possible for nodes to directly detect Byzantine information manipulation attacks from the routing information exchange. In such cases, the routing protocol must include and support indirect communications exchanges between non-adjacent routing peers to provide a secondary channel for performing routing information validation. S-RIP <a href="#Wan2004">[Wan2004]</a> is an example of the implementation of this type of dedicated routing protocol security where the correctness of aggregate distance vector information can only be validated by initiating confirmation exchanges directly between nodes that are not routing neighbors.</p>
<p id="rfc.section.8.2.5.p.5">Alternatively, an entity external to the routing protocol would be required to collect and audit routing information exchanges to detect the Byzantine attack. In the context of the current security analysis, any protection against Byzantine routing information attacks will need to be directly included within the mechanisms of the ROLL routing protocol.  </p>
<h1 id="rfc.section.8.3"><a href="#rfc.section.8.3">8.3.</a> <a href="#counter-avail-atk" id="counter-avail-atk">Availability Attack Countermeasures</a></h1>
<p id="rfc.section.8.3.p.1">As alluded to before, availability requires that routing information exchanges and forwarding mechanisms be available when needed so as to guarantee proper functioning of the network. This may, e.g., include the correct operation of routing information and neighbor state information exchanges, among others. We will highlight the key features of the security threats along with typical countermeasures to prevent or at least mitigate them. We will also note that an availability attack may be facilitated by an identity attack as well as a replay attack, as was addressed in <a href="#counter-sybil">Section 8.2.3</a> and <a href="#counter-replay">Section 8.2.4</a>, respectively.</p>
<h1 id="rfc.section.8.3.1"><a href="#rfc.section.8.3.1">8.3.1.</a> Countering HELLO Flood Attacks and ACK Spoofing Attacks</h1>
<p id="rfc.section.8.3.1.p.1">HELLO Flood <a href="#Karlof2003">[Karlof2003]</a>,<a href="#I-D.suhopark-hello-wsn">[I-D.suhopark-hello-wsn]</a> and ACK Spoofing attacks are different but highly related forms of attacking an LLN. They essentially lead nodes to believe that suitable routes are available even though they are not and hence constitute a serious availability attack.</p>
<p id="rfc.section.8.3.1.p.2">The origin of facilitating a HELLO flood attack lies in the fact that many routing protocols require nodes to send HELLO packets either upon joining or in regular intervals so as to announce or confirm their existence to the network. Those nodes that receive the HELLO packet assume that they are indeed neighbors.</p>
<p id="rfc.section.8.3.1.p.3">With this in mind, a malicious node can send or replay HELLO packets using, e.g., a higher transmission power. That creates the false illusion of being a neighbor to an increased number of nodes in the network, thereby effectively increasing its unidirectional neighborhood cardinality. The high quality of the falsely advertised link may coerce nodes to route data via the malicious node. However, those affected nodes, for which the malicious node is in fact unreachable, never succeed in their delivery and the packets are effectively dropped. The symptoms are hence similar to those of a sinkhole, wormhole and selective forwarding attack.</p>
<p id="rfc.section.8.3.1.p.4">A malicious HELLO flood attack clearly distorts the network topology. It thus affects protocols building and maintaining the network topology as well as routing protocols as such, since the attack is primarily targeted on protocols that require sharing of information for topology maintenance or flow control.</p>
<p id="rfc.section.8.3.1.p.5">To counter HELLO flood attacks, several mutually non-exclusive methods are feasible: </p>

<ul>
  <li>restricting neighborhood cardinality;</li>
  <li>facilitating multipath routing;</li>
  <li>verifying bidirectionality.</li>
</ul>

<p> </p>
<p id="rfc.section.8.3.1.p.6">Restricting the neighborhood cardinality prevents malicious nodes from having an extended set of neighbors beyond some tolerated threshold and thereby preventing topologies to be built where malicious nodes have a false neighborhood set. Furthermore, as shown in <a href="#I-D.suhopark-hello-wsn">[I-D.suhopark-hello-wsn]</a>, if the routing protocol supports multiple paths from a sensing node towards several LBRs then HELLO flood attacks can also be diminished; however, the energy-efficiency of such approach is clearly sub-optimal. Finally, verifying that the link is truly bidirectional by means of, e.g., an ACK handshake and appropriate security measures ensures that a communication link is only established if not only the affected node is within range of the malicious node but also vice versa. Whilst this does not really eliminate the problem of HELLO flooding, it greatly reduces the number of affected nodes and the probability of such an attack succeeding.</p>
<p id="rfc.section.8.3.1.p.7">As for the latter, the adversary may spoof the ACK messages to convince the affected node that the link is truly bidirectional and thereupon drop, tunnel or selectively forward messages. Such ACK spoofing attack is possible if the malicious node has a receiver which is significantly more sensitive than that of a normal node, thereby effectively extending its range. Since an ACK spoofing attack facilitates a HELLO flood attack, similar countermeasure are applicable here. Viable counter and security measures for both attacks have been exposed in <a href="#I-D.suhopark-hello-wsn">[I-D.suhopark-hello-wsn]</a></p>
<h1 id="rfc.section.8.3.2"><a href="#rfc.section.8.3.2">8.3.2.</a> Countering Overload Attacks</h1>
<p id="rfc.section.8.3.2.p.1">Overload attacks are a form of DoS attack in that a malicious node overloads the network with irrelevant traffic, thereby draining the nodes' energy store more quickly, when the nodes rely on batteries or energy scavenging. It thus significantly shortens the lifetime of networks of energy-constrained nodes and constitutes another serious availability attack.</p>
<p id="rfc.section.8.3.2.p.2">With energy being one of the most precious assets of LLNs, targeting its availability is a fairly obvious attack. Another way of depleting the energy of an LLN node is to have the malicious node overload the network with irrelevant traffic. This impacts availability since certain routes get congested which: </p>

<ul>
  <li>renders them useless for affected nodes and data can hence not be delivered;</li>
  <li>makes routes longer as shortest path algorithms work with the congested network;</li>
  <li>depletes battery and energy scavenging nodes quicker and thus shortens the network's availability at large.</li>
</ul>

<p> </p>
<p id="rfc.section.8.3.2.p.3">Overload attacks can be countered by deploying a series of mutually non-exclusive security measures: </p>

<ul>
  <li>introduce quotas on the traffic rate each node is allowed to send;</li>
  <li>isolate nodes which send traffic above a certain threshold based on system operation characteristics;</li>
  <li>allow only trusted data to be received and forwarded.</li>
</ul>

<p> </p>
<p id="rfc.section.8.3.2.p.4">As for the first one, a simple approach to minimize the harmful impact of an overload attack is to introduce traffic quotas. This prevents a malicious node from injecting a large amount of traffic into the network, even though it does not prevent said node from injecting irrelevant traffic at all. Another method is to isolate nodes from the network at the network layer once it has been detected that more traffic is injected into the network than allowed by a prior set or dynamically adjusted threshold. Finally, if communication is sufficiently secured, only trusted nodes can receive and forward traffic which also lowers the risk of an overload attack.</p>
<p id="rfc.section.8.3.2.p.5">Receiving nodes that validate signatures and sending nodes that encrypt messages need to be cautious of cryptographic processing usage when validating signatures and encrypting messages. Where feasible, certificates should be validated prior to use of the associated keys to counter potential resource overloading attacks.  The associated design decision needs to also consider that the validation process requires resources and thus itself could be exploited for attacks. Alternatively, resource management limits can be placed on routing security processing events (see the comment in Section 6, paragraph 4, of <a href="#RFC5751">[RFC5751]</a>).</p>
<h1 id="rfc.section.8.3.3"><a href="#rfc.section.8.3.3">8.3.3.</a> Countering Selective Forwarding Attacks</h1>
<p id="rfc.section.8.3.3.p.1">Selective forwarding attacks are a form of DoS attack which impacts the availability of the generated routing paths.</p>
<p id="rfc.section.8.3.3.p.2">A selective forwarding attack may be done by a node involved with the routing process, or it may be done by what otherwise appears to be a passive antenna or other RF feature or device, but is in fact an active (and selective) device.  An RF antenna/repeater which is not selective, is not a threat.</p>
<p id="rfc.section.8.3.3.p.3">An insider malicious node basically blends neatly in with the network but then may decide to forward and/or manipulate certain packets. If all packets are dropped, then this attacker is also often referred to as a "black hole". Such a form of attack is particularly dangerous if coupled with sinkhole attacks since inherently a large amount of traffic is attracted to the malicious node and thereby causing significant damage. In a shared medium, an outside malicious node would selectively jam overheard data flows, where the thus caused collisions incur selective forwarding.</p>
<p id="rfc.section.8.3.3.p.4">Selective Forwarding attacks can be countered by deploying a series of mutually non-exclusive security measures: </p>

<ul>
  <li>multipath routing of the same message over disjoint paths;</li>
  <li>dynamically selecting the next hop from a set of candidates.</li>
</ul>

<p> </p>
<p id="rfc.section.8.3.3.p.5">The first measure basically guarantees that if a message gets lost on a particular routing path due to a malicious selective forwarding attack, there will be another route which successfully delivers the data. Such a method is inherently suboptimal from an energy consumption point of view; it is also suboptimal from a network utilization perspective. The second method basically involves a constantly changing routing topology in that next-hop routers are chosen from a dynamic set in the hope that the number of malicious nodes in this set is negligible. A routing protocol that allows for disjoint routing paths may also be useful.</p>
<h1 id="rfc.section.8.3.4"><a href="#rfc.section.8.3.4">8.3.4.</a> Countering Sinkhole Attacks</h1>
<p id="rfc.section.8.3.4.p.1">In sinkhole attacks, the malicious node manages to attract a lot of traffic mainly by advertising the availability of high-quality links even though there are none <a href="#Karlof2003">[Karlof2003]</a>. It hence constitutes a serious attack on availability.</p>
<p id="rfc.section.8.3.4.p.2">The malicious node creates a sinkhole by attracting a large amount of, if not all, traffic from surrounding neighbors by advertising in and outwards links of superior quality. Affected nodes hence eagerly route their traffic via the malicious node which, if coupled with other attacks such as selective forwarding, may lead to serious availability and security breaches. Such an attack can only be executed by an inside malicious node and is generally very difficult to detect. An ongoing attack has a profound impact on the network topology and essentially becomes a problem of flow control.</p>
<p id="rfc.section.8.3.4.p.3">Sinkhole attacks can be countered by deploying a series of mutually non-exclusive security measures: </p>

<ul>
  <li>use geographical insights for flow control;</li>
  <li>isolate nodes which receive traffic above a certain threshold;</li>
  <li>dynamically pick up next hop from set of candidates;</li>
  <li>allow only trusted data to be received and forwarded.</li>
</ul>

<p> </p>
<p id="rfc.section.8.3.4.p.4">Whilst most of these countermeasures have been discussed before, the use of geographical information deserves further attention.  Essentially, if geographic positions of nodes are available, then the network can assure that data is actually routed towards the intended destination and not elsewhere. On the other hand, geographic position is a sensitive information that has security and/or privacy consequences (see <a href="#conff">Section 9.1</a>).</p>
<h1 id="rfc.section.8.3.5"><a href="#rfc.section.8.3.5">8.3.5.</a> Countering Wormhole Attacks</h1>
<p id="rfc.section.8.3.5.p.1">In wormhole attacks at least two malicious nodes shortcut or divert the usual routing path by means of a low-latency out-of-band channel <a href="#Karlof2003">[Karlof2003]</a>. This changes the availability of certain routing paths and hence constitutes a serious security breach.</p>
<p id="rfc.section.8.3.5.p.2">Essentially, two malicious insider nodes use another, more powerful, transmitter to communicate with each other and thereby distort the would-be-agreed routing path. This distortion could involve shortcutting and hence paralyzing a large part of the network; it could also involve tunneling the information to another region of the network where there are, e.g., more malicious nodes available to aid the intrusion or where messages are replayed, etc.  In conjunction with selective forwarding, wormhole attacks can create race conditions which impact topology maintenance, routing protocols as well as any security suits built on "time of check" and "time of use".</p>
<p id="rfc.section.8.3.5.p.3">Wormhole attacks are very difficult to detect in general but can be mitigated using similar strategies as already outlined above in the context of sinkhole attacks.</p>
<h1 id="rfc.section.9"><a href="#rfc.section.9">9.</a> <a href="#roll-sec-features" id="roll-sec-features">ROLL Security Features</a></h1>
<p id="rfc.section.9.p.1">The assessments and analysis in <a href="#roll-threats">Section 5</a> examined all areas of threats and attacks that could impact routing, and the countermeasures presented in <a href="#counter-measur">Section 8</a> were reached without confining the consideration to means only available to routing. This section puts the results into perspective and provides a framework for addressing the derived set of security objectives that must be met by the routing protocol(s) specified by the ROLL Working Group. It bears emphasizing that the target here is a generic, universal form of the protocol(s) specified and the normative keywords are mainly to convey the relative level of importance or urgency of the features specified.</p>
<p id="rfc.section.9.p.2">In this view, 'MUST' is used to define the requirements that are specific to the routing protocol and that are essential for an LLN routing protocol to ensure that routing operation can be maintained.  Adherence to MUST requirements is needed to directly counter attacks that can affect the routing operation (such as those that can impact maintained or derived routing/forwarding tables). 'SHOULD' is used to define requirements that counter indirect routing attacks where such attacks do not of themselves affect routing but can assist an attacker in focusing its attack resources to impact network operation (such as DoS targeting of key forwarding nodes). 'MAY' covers optional requirements that can further enhance security by increasing the space over which an attacker must operate or the resources that must be applied. While in support of routing security, where appropriate, these requirements may also be addressed beyond the network routing protocol at other system communications layers.</p>
<p id="rfc.section.9.p.3">The first part of this section, <a href="#conff">Section 9.1</a> to <a href="#avaf">Section 9.3</a>, is a prescription of ROLL security features of measures that can be addressed as part of the routing protocol itself. As routing is one component of an LLN system, the actual strength of the security services afforded to it should be made to conform to each system's security policy; how a design may address the needs of the urban, industrial, home automation, and building automation application domains also needs to be considered. The second part of this section, <a href="#keymanage">Section 9.4</a> and <a href="#match-needs">Section 9.5</a>, discusses system security aspects that may impact routing but that also require considerations beyond the routing protocol, as well as potential approaches.</p>
<p id="rfc.section.9.p.4">If an LLN employs multicast and/or anycast, these alternative communications modes MUST be secured with the same routing security services specified in this section. Furthermore, irrespective of the modes of communication, nodes MUST provide adequate physical tamper resistance commensurate with the particular application domain environment to ensure the confidentiality, integrity, and availability of stored routing information.</p>
<h1 id="rfc.section.9.1"><a href="#rfc.section.9.1">9.1.</a> <a href="#conff" id="conff">Confidentiality Features</a></h1>
<p id="rfc.section.9.1.p.1">With regard to confidentiality, protecting the routing/topology information from unauthorized disclosure is not directly essential to maintaining the routing function. Breaches of confidentiality may lead to other attacks or the focusing of an attacker's resources (see <a href="#confident-threat">Section 5.2</a>) but does not of itself directly undermine the operation of the routing function. However, to protect against, and reduce consequences from other more direct attacks, routing information should be protected. Thus, a secured ROLL protocol: </p>

<ul>
  <li>MUST implement payload encryption;</li>
  <li>MUST provide privacy when geographic information is used (see, e.g., <a href="#RFC3693">[RFC3693]</a>);</li>
  <li>MAY provide tunneling;</li>
  <li>MAY provide load balancing.</li>
</ul>

<p> </p>
<p id="rfc.section.9.1.p.2">Where confidentiality is incorporated into the routing exchanges, encryption algorithms and key lengths need to be specified in accordance with the level of protection dictated by the routing protocol and the associated application domain transport network. In terms of the life time of the keys, the opportunity to periodically change the encryption key increases the offered level of security for any given implementation. However, where strong cryptography is employed, physical, procedural, and logical data access protection considerations may have more significant impact on cryptoperiod selection than algorithm and key size factors. Nevertheless, in general, shorter cryptoperiods, during which a single key is applied, will enhance security.</p>
<p id="rfc.section.9.1.p.3">Given the mandatory protocol requirement to implement routing node authentication as part of routing integrity (see <a href="#intf">Section 9.2</a>), key exchanges may be coordinated as part of the integrity verification process. This provides an opportunity to increase the frequency of key exchange and shorten the cryptoperiod as a complement to the key length and encryption algorithm required for a given application domain. For LLNs, the coordination of confidentiality key management with the implementation of node device authentication can thus reduce the overhead associated with supporting data confidentiality. If a new ciphering key is concurrently generated or updated in conjunction with the mandatory authentication exchange occurring with each routing peer association, signaling exchange overhead can be reduced.</p>
<h1 id="rfc.section.9.2"><a href="#rfc.section.9.2">9.2.</a> <a href="#intf" id="intf">Integrity Features</a></h1>
<p id="rfc.section.9.2.p.1">The integrity of routing information provides the basis for ensuring that the function of the routing protocol is achieved and maintained. To protect integrity, a secured ROLL protocol: </p>

<ul>
  <li>MUST provide and verify message integrity (including integrity of the encrypted message when confidentiality is applied);</li>
  <li>MUST verify the authenticity and liveness of both principals of a connection (independent of the device interface over which the information is received or accessed);</li>
  <li>MUST verify message sequence;</li>
  <li>SHOULD incorporate protocol-specific parameter validity range checks, change increments, and message event frequency checks, etc. as a means of countering intentional or unintentional Byzantine threats;</li>
  <li>MAY incorporate external consistency checking and auditing of routing information to protect against intentional or unintentional Byzantine-induced network anomalies.</li>
</ul>

<p> </p>
<p id="rfc.section.9.2.p.2">In conjunction with the integrity protection requirements, a secured ROLL protocol SHOULD log, against the offending node, any security failure that occurs after a valid integrity check. The record policy configuration) can provide the basis for nodes to avoid initiating routing access to the offender or be used for further system countermeasures in the case of potential insider attacks. All integrity security failures SHOULD be logged, where feasible, but cannot be reliably considered as countering against the offending source(s).</p>
<p id="rfc.section.9.2.p.3">Depending on the nature of the routing protocol, e.g., distance vector or link state, additional measures may be necessary when the validity of the routing information is of concern. In the most basic form, verification of routing peer authenticity and liveliness can be used to build a "chain of trust" along the path the routing information flows, such that network-wide information is validated through the concatenation of trust established at each individual routing peer exchange. This is particularly important in the case of distance vector-based routing protocols, where information is updated at intermediate nodes, In such cases, there are no direct means within routing for a receiver to verify the validity of the routing information beyond the current exchange; as such, nodes would need to be able to communicate and request information from non-adjacent peers (see <a href="#Wan2004">[Wan2004]</a>) to provide information integrity assurances. With link state-based protocols, on the other hand, routing information can be signed at the source thus providing a means for validating information that originates beyond a routing peer.  Therefore, where necessary, a secured ROLL protocol MAY use security auditing mechanisms that are external to routing to verify the validity of the routing information content exchanged among routing peers.</p>
<h1 id="rfc.section.9.3"><a href="#rfc.section.9.3">9.3.</a> <a href="#avaf" id="avaf">Availability Features</a></h1>
<p id="rfc.section.9.3.p.1">Availability of routing information is linked to system and network availability which in the case of LLNs require a broader security view beyond the requirements of the routing entities (see <a href="#match-needs">Section 9.5</a>). Where availability of the network is compromised, routing information availability will be accordingly affected. However, to specifically assist in protecting routing availability: </p>

<ul>
  <li>MAY restrict neighborhood cardinality;</li>
  <li>MAY use multiple paths;</li>
  <li>MAY use multiple destinations;</li>
  <li>MAY choose randomly if multiple paths are available;</li>
  <li>MAY set quotas to limit transmit or receive volume;</li>
  <li>MAY use geographic information for flow control.</li>
</ul>

<p> </p>
<h1 id="rfc.section.9.4"><a href="#rfc.section.9.4">9.4.</a> <a href="#keymanage" id="keymanage">Key Management</a></h1>
<p id="rfc.section.9.4.p.1">The functioning of the routing security services requires keys and credentials. Therefore, even though not directly a ROLL security requirement, an LLN MUST have a process for initial key and credential configuration, as well as secure storage within the associated devices (including use of trusted platform modules where feasible and appropriate to the operating environment). Beyond initial credential configuration, an LLN is also encouraged to have automatic procedures for the revocation and replacement of the maintained security credentials.</p>
<p id="rfc.section.9.4.p.2">Peer associations and signaling exchanges require the generation and use of keys that MAY be derived from secret or public key exchanges as part of the routing signaling exchange or be directly obtained through device configuration. The routing protocol specification MUST include mechanisms to identify and synchronize these keys.</p>
<p id="rfc.section.9.4.p.3">For keys used to establish peer associations, the routing protocol(s) specified by the ROLL Working Group SHOULD employ key management mechanisms consistent with the guidelines given in <a href="#RFC4107">[RFC4107]</a>. Based on that RFC's recommendations, many LLNs, particularly given the intended scale and ad hoc device associations, will meet the requirement for supporting automated key management in conjunction with the routing protocol operation. These short-term, automated routing session keys may be derived from pre-stored security credentials or can be generated through key management mechanisms that are defined as part of the routing protocol exchange. Beyond the automated short-term keys, a long-term key management mechanism SHOULD also be defined for changing or updating the credentials from which short-term routing association key material is derived.</p>
<p id="rfc.section.9.4.p.4">The use of a public key infrastructure (PKI), where feasible, can be used to support authenticated short-term key management as well as the distribution of long-term routing security keying material. Note that where the option for a PKI is supported for security of the routing protocol itself, the routing protocol MUST include provisions for public key certificates to be included or referenced within routing messages to allow a node's public key to be shared with communicating peers. Even if the certificate itself is not distributed by the node, there needs to be a mechanism to inform the receiving node where to find the certificate and obtain associated validation information; see <a href="#RFC3029">[RFC3029]</a> for an example of the kind of localized PKI support that may be applied in a given LLN environment. Where PKI systems are not feasible, the key management system MUST support means for secure configuration, device authentication, and adherence to secure key wrapping principles for the secure distribution and update of device keys.</p>
<p id="rfc.section.9.4.p.5">LLN routing protocols SHOULD be designed to allow the use of existing and validated key management schemes. As part of the LLN optimization, these schemes may be independent of the routing protocol and part of the broader LLN system security specifications. Where the long-term key management is defined separately from the routing protocol security, LLN application domains can appropriately employ IETF-standard key management specifications. Established key management solutions such as IKEv2 <a href="#RFC5996">[RFC5996]</a> or MIKEY <a href="#RFC3830">[RFC3830]</a>, which supports several alternative private, public, or Diffie-Hellman key distribution methods (see <a href="#RFC5197">[RFC5197]</a>), can thus be adapted for use in LLNs. For example, see <a href="#I-D.alexander-roll-mikey-lln-key-mgmt">[I-D.alexander-roll-mikey-lln-key-mgmt]</a>. Group key management and distribution methods may also be developed based on the architecture principles defined in MSEC <a href="#RFC4046">[RFC4046]</a>.</p>
<h1 id="rfc.section.9.5"><a href="#rfc.section.9.5">9.5.</a> <a href="#match-needs" id="match-needs">Consideration on Matching Application Domain Needs</a></h1>
<p id="rfc.section.9.5.p.1">Providing security within an LLN requires considerations that extend beyond routing security to the broader LLN application domain security implementation. In other words, as routing is one component of an LLN system, the actual strength of the implemented security algorithms for the routing protocol MUST be made to conform to the system's target level of security. The development so far takes into account collectively the impacts of the issues gathered from <a href="#RFC5548">[RFC5548]</a>, <a href="#RFC5673">[RFC5673]</a>, <a href="#RFC5826">[RFC5826]</a>, and <a href="#RFC5867">[RFC5867]</a>. The following two subsections first consider from an architectural perspective how the security design of a ROLL protocol may be made to adapt to the four application domains, and then examine mechanisms and protocol operations issues.</p>
<h1 id="rfc.section.9.5.1"><a href="#rfc.section.9.5.1">9.5.1.</a> <a href="#roll-sec-arch" id="roll-sec-arch">Security Architecture</a></h1>
<p id="rfc.section.9.5.1.p.1">The first challenge for a ROLL protocol security design is to have an architecture that can adequately address a set of very diverse needs. It is mainly a consequence of the fact that there are both common and non-overlapping requirements from the four application domains, while, conceivably, each individual application will present yet its own unique constraints.</p>
<p id="rfc.section.9.5.1.p.2">For a ROLL protocol, the security requirements defined in <a href="#conff">Section 9.1</a> to <a href="#keymanage">Section 9.4</a> can be addressed at two levels: 1) through measures implemented directly within the routing protocol itself and initiated and controlled by the routing protocol entities; or 2) through measures invoked on behalf of the routing protocol entities but implemented within the part of the network over which the protocol exchanges occur.</p>
<p id="rfc.section.9.5.1.p.3">Where security is directly implemented as part of the routing protocol the security requirements configured by the user (system administrator) will operate independently of the lower layers.  OSPFv2 <a href="#RFC2328">[RFC2328]</a> is an example of such an approach in which security parameters are exchanged and assessed within the routing protocol messages. In this case, the mechanism may be, e.g., a header containing security material of configurable security primitives in the fashion of OSPFv2 or RIPv2 <a href="#RFC2453">[RFC2453]</a>. Where IPsec <a href="#RFC4301">[RFC4301]</a> is employed to secure the network, the included protocol-specific (OSPF or RIP) security elements are in addition to and independent of those at the network layer. In the case of LLNs or other networks where system security mandates protective mechanisms at other lower layers of the network, security measures implemented as part of the routing protocol will be redundant to security measures implemented elsewhere as part of the protocol stack.</p>
<p id="rfc.section.9.5.1.p.4">Security mechanisms built into the routing protocol can ensure that all desired countermeasures can be directly addressed by the protocol all the way to the endpoint of the routing exchange. In particular, routing protocol Byzantine attacks by a compromised node that retains valid network security credentials can only be detected at the level of the information exchanged within the routing protocol. Such attacks aimed at the manipulation of the routing information can only be fully addressed through measures operating directly between the routing entities themselves or external entities able to access and analyze the routing information (see discussion in <a href="#counter-byzantine">Section 8.2.5</a>).</p>
<p id="rfc.section.9.5.1.p.5">On the other hand, it is more desirable from an LLN device perspective that the ROLL protocol is integrated into the framework of an overall system architecture where the security facility may be shared by different applications and/or across layers for efficiency, and where security policy and configurations can be consistently specified. See, for example, considerations made in RIPng <a href="#RFC2080">[RFC2080]</a> or the approach presented in <a href="#Messerges2003">[Messerges2003]</a>.</p>
<p id="rfc.section.9.5.1.p.6">Where the routing protocol is able to rely on security measures configured within other layers of the protocol stack, greater system efficiency can be realized by avoiding potentially redundant security. Relying on an open trust model <a href="#Messerges2003">[Messerges2003]</a>, the security requirements of the routing protocol can be more flexibly met at different layers of the transport network; measures that must be applied to protect the communications network are concurrently able to provide the needed routing protocol protection.</p>
<p id="rfc.section.9.5.1.p.7">For example, where a given security encryption scheme is deemed the appropriate standard for network confidentiality of data exchanges at the link layer, that level of security is directly provided to routing protocol exchanges across the local link.  Similarly, where a given authentication procedure is stipulated as part of the standard required for authenticating network traffic, that security provision can then meet the requirement needed for authentication of routing exchanges. In addition, in the context of the different LLN application domains, the level of security specified for routing can and should be consistent with that considered appropriate for protecting the network within the given environment.</p>
<p id="rfc.section.9.5.1.p.8">A ROLL protocol MUST be made flexible by a design that offers the configuration facility so that the user (network administrator) can choose the security settings that match the application's needs.  Furthermore, in the case of LLNs, that flexibility SHOULD extend to allowing the routing protocol security requirements to be met by measures applied at different protocol layers, provided the identified requirements are collectively met.</p>
<p id="rfc.section.9.5.1.p.9">Since Byzantine attackers that can affect the validity of the information content exchanged between routing entities can only be directly countered at the routing protocol level, the ROLL protocol MAY support mechanisms for verifying routing data validity that extend beyond the chain of trust created through device authentication. This protocol-specific security mechanism SHOULD be made optional within the protocol allowing it to be invoked according to the given routing protocol and application domain and as selected by the system user. All other ROLL security mechanisms needed to meet the above identified routing security requirements can be flexibly implemented within the transport network (at the IP network layer or higher or lower protocol layers(s)) according to the particular application domain and user network configuration.</p>
<p id="rfc.section.9.5.1.p.10">Based on device capabilities and the spectrum of operating environments it would be difficult for a single fixed security design to be applied to address the diversified needs of the urban, industrial, home, and building ROLL application domains, and foreseeable others, without forcing a very low common denominator set of requirements. On the other hand, providing four individual domain designs that attempt to a priori match each individual domain is also very unlikely to provide a suitable answer given the degree of network variability even within a given domain; furthermore, the type of link layers in use within each domain also influences the overall security.</p>
<p id="rfc.section.9.5.1.p.11">Instead, the framework implementation approach recommended is for optional, routing protocol-specific measures that can be applied separately from, or together with, flexible transport network mechanisms. Protocol-specific measures include the specification of valid parameter ranges, increments and/or event frequencies that can be verified by individual routing devices. In addition to deliberate attacks this allows basic protocol sanity checks against unintentional mis-configuration. Transport network mechanisms would include out-of-band communications that may be defined to allow an external entity to request and process individual device information as a means to effecting an external verification of the derived network routing information to identify the existence of intentional or unintentional network anomalies.</p>
<p id="rfc.section.9.5.1.p.12">This approach allows countermeasures against byzantine attackers to be applied in environments where applicable threats exist. At the same time, it allows routing protocol security to be supported through measures implemented within the transport network that are consistent with available system resources and commensurate and consistent with the security level and strength applied in the particular application domain networks.</p>
<h1 id="rfc.section.9.5.2"><a href="#rfc.section.9.5.2">9.5.2.</a> <a href="#roll-sec-mech" id="roll-sec-mech">Mechanisms and Operations</a></h1>
<p id="rfc.section.9.5.2.p.1">With an architecture allowing different configurations to meet the application domain needs, the task is then to find suitable mechanisms. For example, one of the main problems of synchronizing security states of sleepy nodes lies in difficulties in authentication; these nodes may not have received in time the most recent update of security material. Similarly, the issues of minimal manual configuration, prolonged rollout and delayed addition of nodes, and network topology changes also complicate security management. In many cases the ROLL protocol may need to bootstrap the authentication process and allow for a flexible expiration scheme of authentication credentials. This exemplifies the need for the coordination and interoperation between the requirements of the ROLL routing protocol and that of the system security elements.</p>
<p id="rfc.section.9.5.2.p.2">Similarly, the vulnerability brought forth by some special-function nodes, e.g., LBRs requires the assurance, particularly, of the availability of communication channels and node resources, or that the neighbor discovery process operates without undermining routing availability.</p>
<p id="rfc.section.9.5.2.p.3">There are other factors which are not part of a ROLL routing protocol but which can still affect its operation. These include elements such as weaker barrier to accessing the data or security material stored on the nodes through physical means; therefore, the internal and external interfaces of a node need to be adequate for guarding the integrity, and possibly the confidentiality, of stored information, as well as the integrity of routing and route generation processes.</p>
<p><a href="#Fig5">Figure 5</a> provides an overview of the larger context of system security and the relationship between ROLL requirements and measures and those that relate to the LLN system.</p>
<div id="rfc.figure.5"/>
<div id="Fig5"/>
<p/>
<pre>
              
                           Security Services for
                             ROLL-Addressable
                           Security Requirements
                                |        |
                            +---+        +---+
                Node_i      |                |      Node_j
                       _____v___          ___v_____
     Specify Security /         \        /         \ Specify Security
     Requirements     | Routing |        | Routing |     Requirements
            +---------| Protocol|        | Protocol|---------+
            |         | Entity  |        | Entity  |         |
            |         \_________/        \_________/         |
            |               |                |               |
            |ROLL-Specified |                | ROLL-Specified|
           ---Interface     |                |     Interface---
            |     ......................................     |
            |     :         |                |         :     |
            |     :   +-----+----+      +----+-----+   :     |
            |     :   |Transport/|      |Transport/|   :     |
        ____v___  : +&gt;|Network   |      |Network   |&lt;+ :  ___v____
       /        \ : | +-----+----+      +----+-----+ | : /        \
       |        |-:-+       |                |       +-:-|        |
       |Security| :   +-----+----+      +----+-----+   : |Security|
    +-&gt;|Services|-:--&gt;|   Link   |      |   Link   |&lt;--:-|Services|&lt;-+
    |  |Entity  | :   +-----+----+      +----+-----+   : |Entity  |  |
    |  |        |-:-+       |                |       +-:-|        |  |
    |  \________/ : | +-----+----+      +----+-----+ | : \________/  |
    |             : +&gt;| Physical |      | Physical |&lt;+ :             |
   Application    :   +-----+----+      +----+-----+   :    Application
   Domain User    :         |                |         :    Domain User
   Configuration  :         |__Comm. Channel_|         :  Configuration
                  :                                    :
                  ...Protocol Stack.....................

              
            </pre>
<p/>
<p class="figure">Figure 5: LLN Device Security Model</p>
<h1 id="rfc.section.10"><a href="#rfc.section.10">10.</a> <a href="#IANA" id="IANA">IANA Considerations</a></h1>
<p id="rfc.section.10.p.1">This memo includes no request to IANA.</p>
<h1 id="rfc.section.11"><a href="#rfc.section.11">11.</a> <a href="#Security" id="Security">Security Considerations</a></h1>
<p id="rfc.section.11.p.1">The analysis presented in this document provides security analysis and design guidelines with a scope limited to ROLL. Security services are identified as requirements for securing ROLL. The specific mechanisms to be used to deal with each threat is specified in link-layer and deployment specific applicability statements.</p>
<h1 id="rfc.section.12"><a href="#rfc.section.12">12.</a> <a href="#Acknowledgements" id="Acknowledgements">Acknowledgments</a></h1>
<p id="rfc.section.12.p.1">The authors would like to acknowledge the review and comments from Rene Struik and JP Vasseur. The authors would also like to acknowledge the guidance and input provided by the ROLL Chairs, David Culler, and JP Vasseur, and the Area Director Adrian Farrel.</p>
<p id="rfc.section.12.p.2">This document started out as a combined threat and solutions document.  As a result of security review, the document was split up by ROLL co-Chair Michael Richardson and security Area Director Sean Turner as it went through the IETF publication process.  The solutions to the threads are application and layer-2 specific, and have therefore been moved to the relevant applicability statements.</p>
<p id="rfc.section.12.p.3">Ines Robles kept track of the many issues that were raised during the development of this document</p>
<h1 id="rfc.references"><a href="#rfc.references">13.</a> References</h1>
<h1 id="rfc.references.1"><a href="#rfc.references.1">13.1.</a> Normative References</h1>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="RFC2119">[RFC2119]</b>
      </td>
      <td class="top"><a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC4107">[RFC4107]</b>
      </td>
      <td class="top"><a>Bellovin, S.</a> and <a>R. Housley</a>, "<a href="http://tools.ietf.org/html/rfc4107">Guidelines for Cryptographic Key Management</a>", BCP 107, RFC 4107, June 2005.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC4301">[RFC4301]</b>
      </td>
      <td class="top"><a>Kent, S.</a> and <a>K. Seo</a>, "<a href="http://tools.ietf.org/html/rfc4301">Security Architecture for the Internet Protocol</a>", RFC 4301, December 2005.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC6550">[RFC6550]</b>
      </td>
      <td class="top"><a>Winter, T.</a>, <a>Thubert, P.</a>, <a>Brandt, A.</a>, <a>Hui, J.</a>, <a>Kelsey, R.</a>, <a>Levis, P.</a>, <a>Pister, K.</a>, <a>Struik, R.</a>, <a>Vasseur, JP.</a> and <a>R. Alexander</a>, "<a href="http://tools.ietf.org/html/rfc6550">RPL: IPv6 Routing Protocol for Low-Power and Lossy Networks</a>", RFC 6550, March 2012.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.references.2"><a href="#rfc.references.2">13.2.</a> Informative References</h1>
<table>
  <tbody>
    <tr><td class="reference"><b id="FIPS197">[FIPS197]</b></td><td class="top"><a>Federal Information Processing Standards Publication 197: Advanced Encryption Standard (AES)</a>", US National Institute of Standards and Technology, Nov. 26 2001.</td>, "</tr>
    <tr>
      <td class="reference">
        <b id="Huang2003">[Huang2003]</b>
      </td>
      <td class="top"><a>Huang, Q.</a>, <a>Cukier, J.</a>, <a>Kobayashi, H.</a>, <a>Liu, B.</a> and <a>J. Zhang</a>, "<a>Fast Authenticated Key Establishment Protocols for Self-Organizing Sensor Networks</a>", in Proceedings of the 2nd ACM International Conference on Wireless Sensor Networks and Applications, San Diego, CA, USA, pp. 141-150, Sept. 19 2003.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="I-D.alexander-roll-mikey-lln-key-mgmt">[I-D.alexander-roll-mikey-lln-key-mgmt]</b>
      </td>
      <td class="top"><a>Alexander, R.</a> and <a>T. Tsao</a>, "<a href="http://tools.ietf.org/html/draft-alexander-roll-mikey-lln-key-mgmt-04">Adapted Multimedia Internet KEYing (AMIKEY): An extension of Multimedia Internet KEYing (MIKEY) Methods for Generic LLN Environments</a>", Internet-Draft draft-alexander-roll-mikey-lln-key-mgmt-04, September 2012.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="I-D.ietf-roll-terminology">[I-D.ietf-roll-terminology]</b>
      </td>
      <td class="top"><a>Vasseur, J.</a>, "<a href="http://tools.ietf.org/html/draft-ietf-roll-terminology-04">Terminology in Low power And Lossy Networks</a>", Internet-Draft draft-ietf-roll-terminology-04, September 2010.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="I-D.suhopark-hello-wsn">[I-D.suhopark-hello-wsn]</b>
      </td>
      <td class="top"><a>Park, S.</a>, "<a href="http://tools.ietf.org/html/draft-suhopark-hello-wsn-00">Routing Security in Sensor Network: HELLO Flood Attack and Defense</a>", Internet-Draft draft-suhopark-hello-wsn-00, December 2005.</td>
    </tr>
    <tr><td class="reference"><b id="IEEE1149.1">[IEEE1149.1]</b></td><td class="top"><a>IEEE Standard Test Access Port and Boundary Scan Architecture</a>", IEEE-SA Standards Board, Jun. 14 2001.</td>, "</tr>
    <tr>
      <td class="reference">
        <b id="ISO.7498-2.1988">[ISO.7498-2.1988]</b>
      </td>
      <td class="top"><a>International Organization for Standardization</a>, "<a>Information Processing Systems - Open Systems Interconnection Reference Model - Security Architecture</a>", ISO Standard 7498-2, 1988.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="Karlof2003">[Karlof2003]</b>
      </td>
      <td class="top"><a>Karlof, C.</a> and <a>D. Wagner</a>, "<a>Secure routing in wireless sensor networks: attacks and countermeasures</a>", Elsevier AdHoc Networks Journal, Special Issue on Sensor Network Applications and Protocols, 1(2):293-315, September 2003.</td>
    </tr>
    <tr><td class="reference"><b id="Kasumi3gpp">[Kasumi3gpp]</b></td><td class="top"><a>3GPP TS 35.202 Specification of the 3GPP confidentiality and integrity algorithms; Document 2: Kasumi specification</a>", 3GPP TSG SA3, 2009.</td>, "</tr>
    <tr>
      <td class="reference">
        <b id="Messerges2003">[Messerges2003]</b>
      </td>
      <td class="top"><a>Messerges, T.</a>, <a>Cukier, J.</a>, <a>Kevenaar, T.</a>, <a>Puhl, L.</a>, <a>Struik, R.</a> and <a>E. Callaway</a>, "<a>Low-Power Security for Wireless Sensor Networks</a>", in Proceedings of the 1st ACM Workshop on Security of Ad Hoc and Sensor Networks, Fairfax, VA, USA, pp. 1-11, Oct. 31 2003.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="Myagmar2005">[Myagmar2005]</b>
      </td>
      <td class="top"><a>Myagmar, S.</a>, <a>Lee, AJ.</a> and <a>W. Yurcik</a>, "<a>Threat Modeling as a Basis for Security Requirements</a>", in Proceedings of the Symposium on Requirements Engineering for Information Security (SREIS'05), Paris, France, pp. 94-102, Aug 29, 2005.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="Perlman1988">[Perlman1988]</b>
      </td>
      <td class="top"><a>Perlman, N.</a>, "<a>Network Layer Protocols with Byzantine Robustness</a>", MIT LCS Tech Report, 429, 1988.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC1142">[RFC1142]</b>
      </td>
      <td class="top"><a href="mailto:Oran@Oran.enet.dec.com" title="Digital Equipment Corporation (DEC)">Oran, D.</a>, "<a href="http://tools.ietf.org/html/rfc1142">OSI IS-IS Intra-domain Routing Protocol</a>", RFC 1142, February 1990.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC2080">[RFC2080]</b>
      </td>
      <td class="top"><a href="mailto:gmalkin@Xylogics.COM" title="Xylogics, Inc.">Malkin, G.</a> and <a href="mailto:minnear@ipsilon.com" title="Ipsilon Networks, Inc.">R. Minnear</a>, "<a href="http://tools.ietf.org/html/rfc2080">RIPng for IPv6</a>", RFC 2080, January 1997.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC2328">[RFC2328]</b>
      </td>
      <td class="top"><a href="mailto:jmoy@casc.com" title="Ascend Communications, Inc.">Moy, J.</a>, "<a href="http://tools.ietf.org/html/rfc2328">OSPF Version 2</a>", STD 54, RFC 2328, April 1998.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC2453">[RFC2453]</b>
      </td>
      <td class="top"><a href="mailto:gmalkin@baynetworks.com" title="Bay Networks">Malkin, G.</a>, "<a href="http://tools.ietf.org/html/rfc2453">RIP Version 2</a>", STD 56, RFC 2453, November 1998.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC3029">[RFC3029]</b>
      </td>
      <td class="top"><a>Adams, C.</a>, <a>Sylvester, P.</a>, <a>Zolotarev, M.</a> and <a>R. Zuccherato</a>, "<a href="http://tools.ietf.org/html/rfc3029">Internet X.509 Public Key Infrastructure Data Validation and Certification Server Protocols</a>", RFC 3029, February 2001.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC3693">[RFC3693]</b>
      </td>
      <td class="top"><a>Cuellar, J.</a>, <a>Morris, J.</a>, <a>Mulligan, D.</a>, <a>Peterson, J.</a> and <a>J. Polk</a>, "<a href="http://tools.ietf.org/html/rfc3693">Geopriv Requirements</a>", RFC 3693, February 2004.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC3830">[RFC3830]</b>
      </td>
      <td class="top"><a>Arkko, J.</a>, <a>Carrara, E.</a>, <a>Lindholm, F.</a>, <a>Naslund, M.</a> and <a>K. Norrman</a>, "<a href="http://tools.ietf.org/html/rfc3830">MIKEY: Multimedia Internet KEYing</a>", RFC 3830, August 2004.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC4046">[RFC4046]</b>
      </td>
      <td class="top"><a>Baugher, M.</a>, <a>Canetti, R.</a>, <a>Dondeti, L.</a> and <a>F. Lindholm</a>, "<a href="http://tools.ietf.org/html/rfc4046">Multicast Security (MSEC) Group Key Management Architecture</a>", RFC 4046, April 2005.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC4593">[RFC4593]</b>
      </td>
      <td class="top"><a>Barbir, A.</a>, <a>Murphy, S.</a> and <a>Y. Yang</a>, "<a href="http://tools.ietf.org/html/rfc4593">Generic Threats to Routing Protocols</a>", RFC 4593, October 2006.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC4732">[RFC4732]</b>
      </td>
      <td class="top"><a>Handley, M.</a>, <a>Rescorla, E.</a>, <a>IAB</a>, "<a href="http://tools.ietf.org/html/rfc4732">Internet Denial-of-Service Considerations</a>", RFC 4732, December 2006.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC4949">[RFC4949]</b>
      </td>
      <td class="top"><a>Shirey, R.</a>, "<a href="http://tools.ietf.org/html/rfc4949">Internet Security Glossary, Version 2</a>", RFC 4949, August 2007.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5197">[RFC5197]</b>
      </td>
      <td class="top"><a>Fries, S.</a> and <a>D. Ignjatic</a>, "<a href="http://tools.ietf.org/html/rfc5197">On the Applicability of Various Multimedia Internet KEYing (MIKEY) Modes and Extensions</a>", RFC 5197, June 2008.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5548">[RFC5548]</b>
      </td>
      <td class="top"><a>Dohler, M.</a>, <a>Watteyne, T.</a>, <a>Winter, T.</a> and <a>D. Barthel</a>, "<a href="http://tools.ietf.org/html/rfc5548">Routing Requirements for Urban Low-Power and Lossy Networks</a>", RFC 5548, May 2009.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5673">[RFC5673]</b>
      </td>
      <td class="top"><a>Pister, K.</a>, <a>Thubert, P.</a>, <a>Dwars, S.</a> and <a>T. Phinney</a>, "<a href="http://tools.ietf.org/html/rfc5673">Industrial Routing Requirements in Low-Power and Lossy Networks</a>", RFC 5673, October 2009.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5751">[RFC5751]</b>
      </td>
      <td class="top"><a>Ramsdell, B.</a> and <a>S. Turner</a>, "<a href="http://tools.ietf.org/html/rfc5751">Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.2 Message Specification</a>", RFC 5751, January 2010.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5826">[RFC5826]</b>
      </td>
      <td class="top"><a>Brandt, A.</a>, <a>Buron, J.</a> and <a>G. Porcu</a>, "<a href="http://tools.ietf.org/html/rfc5826">Home Automation Routing Requirements in Low-Power and Lossy Networks</a>", RFC 5826, April 2010.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5867">[RFC5867]</b>
      </td>
      <td class="top"><a>Martocci, J.</a>, <a>De Mil, P.</a>, <a>Riou, N.</a> and <a>W. Vermeylen</a>, "<a href="http://tools.ietf.org/html/rfc5867">Building Automation Routing Requirements in Low-Power and Lossy Networks</a>", RFC 5867, June 2010.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5996">[RFC5996]</b>
      </td>
      <td class="top"><a>Kaufman, C.</a>, <a>Hoffman, P.</a>, <a>Nir, Y.</a> and <a>P. Eronen</a>, "<a href="http://tools.ietf.org/html/rfc5996">Internet Key Exchange Protocol Version 2 (IKEv2)</a>", RFC 5996, September 2010.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="Wan2004">[Wan2004]</b>
      </td>
      <td class="top"><a>Wan, T.</a>, <a>Kranakis, E.</a> and <a>PC. van Oorschot</a>, "<a>S-RIP: A Secure Distance Vector Routing Protocol</a>", in Proceedings of the 2nd International Conference on Applied Cryptography and Network Security, Yellow Mountain, China, pp. 103-119, Jun. 8-11 2004.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="Wander2005">[Wander2005]</b>
      </td>
      <td class="top"><a>Wander, A.</a>, <a>Gura, N.</a>, <a>Eberle, H.</a>, <a>Gupta, V.</a> and <a>S. Shantz</a>, "<a>Energy analysis of public-key cryptography for wireless sensor networ</a>", in the Proceedings of the Third IEEE International Conference on Pervasive Computing and Communications pp. 324-328, March 8-12 2005.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="Yourdon1979">[Yourdon1979]</b>
      </td>
      <td class="top"><a>Yourdon, E.</a> and <a>L. Constantine</a>, "<a>Structured Design</a>", Yourdon Press, New York, Chapter 10, pp. 187-222, 1979.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.authors">
  <a href="#rfc.authors">Authors' Addresses</a>
</h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Tzeta Tsao</span> 
	  <span class="n hidden">
		<span class="family-name">Tsao</span>
	  </span>
	</span>
	<span class="org vcardline">Cooper Power Systems</span>
	<span class="adr">
	  <span>910 Clopper Rd. Suite 201S</span>

	  <span class="vcardline">
		<span class="locality">Gaithersburg</span>,  
		<span class="region">Maryland</span> 
		<span class="code">20878</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:tzeta.tsao@cooperindustries.com">tzeta.tsao@cooperindustries.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Roger K. Alexander</span> 
	  <span class="n hidden">
		<span class="family-name">Alexander</span>
	  </span>
	</span>
	<span class="org vcardline">Cooper Power Systems</span>
	<span class="adr">
	  <span>910 Clopper Rd. Suite 201S</span>

	  <span class="vcardline">
		<span class="locality">Gaithersburg</span>,  
		<span class="region">Maryland</span> 
		<span class="code">20878</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:roger.alexander@cooperindustries.com">roger.alexander@cooperindustries.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Mischa Dohler</span> 
	  <span class="n hidden">
		<span class="family-name">Dohler</span>
	  </span>
	</span>
	<span class="org vcardline">CTTC</span>
	<span class="adr">
	  <span>Parc Mediterrani de la Tecnologia, Av. Canal Olimpic S/N</span>

	  <span class="vcardline">
		<span class="locality">Castelldefels</span>,  
		<span class="region">Barcelona</span> 
		<span class="code">08860</span>
	  </span>
	  <span class="country-name vcardline">Spain</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:mischa.dohler@cttc.es">mischa.dohler@cttc.es</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Vanesa Daza</span> 
	  <span class="n hidden">
		<span class="family-name">Daza</span>
	  </span>
	</span>
	<span class="org vcardline">Universitat Pompeu Fabra</span>
	<span class="adr">
	  <span>P/ Circumval.lacio 8, Oficina 308</span>

	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region">Barcelona</span> 
		<span class="code">08003</span>
	  </span>
	  <span class="country-name vcardline">Spain</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:vanesa.daza@upf.edu">vanesa.daza@upf.edu</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Angel Lozano</span> 
	  <span class="n hidden">
		<span class="family-name">Lozano</span>
	  </span>
	</span>
	<span class="org vcardline">Universitat Pompeu Fabra</span>
	<span class="adr">
	  <span>P/ Circumval.lacio 8, Oficina 309</span>

	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region">Barcelona</span> 
		<span class="code">08003</span>
	  </span>
	  <span class="country-name vcardline">Spain</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:angel.lozano@upf.edu">angel.lozano@upf.edu</a></span>

  </address>
</div>

</body>
</html>